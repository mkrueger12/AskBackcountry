2023-11-06 08:09:58,892 - INFO - User query: What is the weather a vail mountain tomorrow?
2023-11-06 08:10:02,605 - INFO - Method selected: weather_forecast
2023-11-06 08:10:03,206 - ERROR - Error occurred: Expecting value: line 1 column 1 (char 0)
2023-11-06 08:11:18,237 - INFO - User query: What is the weather a vail mountain tomorrow?
2023-11-06 08:11:21,440 - INFO - Method selected: weather_forecast
2023-11-06 08:11:22,161 - ERROR - Error occurred: Expecting value: line 1 column 1 (char 0)
2023-11-06 08:16:53,889 - INFO - User query: What is the weather a vail mountain tomorrow?
2023-11-06 08:16:56,704 - INFO - Method selected: weather_forecast
2023-11-06 08:18:57,123 - INFO - User query: What is the weather a vail mountain tomorrow?
2023-11-06 08:18:57,143 - INFO - Method selected: weather_forecast
2023-11-06 08:18:57,952 - ERROR - Error occurred: Expecting value: line 1 column 1 (char 0)
2023-11-06 08:21:50,085 - INFO - User query: What is the weather a vail mountain tomorrow?
2023-11-06 08:21:55,404 - INFO - Method selected: weather_forecast
2023-11-06 08:21:56,069 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None#### Example ###Text: How much snow is at Loveland Pass?Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}, Output: None
2023-11-06 08:21:56,072 - ERROR - Error occurred: Expecting value: line 1 column 1 (char 0)
2023-11-06 08:24:45,378 - INFO - User query: What is the weather a vail mountain tomorrow?
2023-11-06 08:24:49,792 - INFO - Method selected: weather_forecast
2023-11-06 08:24:50,399 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None#### Example ###Text: How much snow is at Loveland Pass?Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}, Output: None
2023-11-06 08:24:50,401 - ERROR - Error occurred: Expecting value: line 1 column 1 (char 0)
2023-11-06 08:24:50,404 - ERROR - Error occurred: 'NoneType' object is not subscriptable
2023-11-06 08:25:12,209 - INFO - User query: What is the weather at Vail Mountain, CO tomorrow?
2023-11-06 08:25:15,568 - INFO - Method selected: weather_forecast
2023-11-06 08:25:28,186 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None#### Example ###Text: How much snow is at Loveland Pass?Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}, Output: {"county": "Eagle", "state": "CO", "elevation": 11500, "latitude": 39.6403, "longitude": -106.3742}
2023-11-06 08:25:28,192 - INFO - Getting weather forecast for Latitude: 39.6403, Longitude: -106.3742
2023-11-06 08:25:29,461 - ERROR - Error occurred: 'properties'
2023-11-06 08:32:30,306 - INFO - User query: What is the weather at Vail Mountain, CO tomorrow?
2023-11-06 08:32:30,322 - INFO - Method selected: weather_forecast
2023-11-06 08:32:34,266 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}, Output: {"county": "Eagle", "state": "CO", "elevation": 11500, "latitude": 39.6403, "longitude": -106.3742}
2023-11-06 08:32:34,272 - INFO - Getting weather_forecast for Latitude: 39.6403, Longitude: -106.3742
2023-11-06 08:32:34,691 - INFO - Generating response - System Context: You are a helpful assistant. Answer the user question based on the context below. Consider summarizing the context. <context> ["Forecast: [{'number': 1, 'name': 'Today', 'startTime': '2023-11-06T08:00:00-07:00', 'endTime': '2023-11-06T18:00:00-07:00', 'isDaytime': True, 'temperature': 54, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -6.111111111111111}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 41}, 'windSpeed': '5 to 20 mph', 'windDirection': 'SW', 'icon': 'https://api.weather.gov/icons/land/day/sct?size=medium', 'shortForecast': 'Mostly Sunny', 'detailedForecast': 'Mostly sunny, with a high near 54. Southwest wind 5 to 20 mph, with gusts as high as 35 mph.'}, {'number': 2, 'name': 'Tonight', 'startTime': '2023-11-06T18:00:00-07:00', 'endTime': '2023-11-07T06:00:00-07:00', 'isDaytime': False, 'temperature': 33, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -6.666666666666667}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 49}, 'windSpeed': '15 to 20 mph', 'windDirection': 'WSW', 'icon': 'https://api.weather.gov/icons/land/night/few?size=medium', 'shortForecast': 'Mostly Clear', 'detailedForecast': 'Mostly clear, with a low around 33. West southwest wind 15 to 20 mph.'}, {'number': 3, 'name': 'Tuesday', 'startTime': '2023-11-07T06:00:00-07:00', 'endTime': '2023-11-07T18:00:00-07:00', 'isDaytime': True, 'temperature': 55, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 20}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -6.111111111111111}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 52}, 'windSpeed': '20 to 30 mph', 'windDirection': 'WSW', 'icon': 'https://api.weather.gov/icons/land/day/wind_few/snow,20?size=medium', 'shortForecast': 'Sunny then Slight Chance Rain And Snow Showers', 'detailedForecast': 'A slight chance of rain and snow showers after 5pm. Sunny, with a high near 55. West southwest wind 20 to 30 mph, with gusts as high as 45 mph. Chance of precipitation is 20%.'}, {'number': 4, 'name': 'Tuesday Night', 'startTime': '2023-11-07T18:00:00-07:00', 'endTime': '2023-11-08T06:00:00-07:00', 'isDaytime': False, 'temperature': 26, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 60}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -3.3333333333333335}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 87}, 'windSpeed': '10 to 20 mph', 'windDirection': 'W', 'icon': 'https://api.weather.gov/icons/land/night/snow,50/snow,60?size=medium', 'shortForecast': 'Snow Showers Likely', 'detailedForecast': 'Snow showers likely. Mostly cloudy, with a low around 26. West wind 10 to 20 mph, with gusts as high as 35 mph. Chance of precipitation is 60%. New snow accumulation of around one inch possible.'}, {'number': 5, 'name': 'Wednesday', 'startTime': '2023-11-08T06:00:00-07:00', 'endTime': '2023-11-08T18:00:00-07:00', 'isDaytime': True, 'temperature': 40, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 60}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -3.888888888888889}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 92}, 'windSpeed': '5 to 10 mph', 'windDirection': 'NW', 'icon': 'https://api.weather.gov/icons/land/day/snow,60/snow,50?size=medium', 'shortForecast': 'Snow Showers Likely', 'detailedForecast': 'Snow showers likely. Mostly cloudy, with a high near 40. Northwest wind 5 to 10 mph. Chance of precipitation is 60%. New snow accumulation of 1 to 3 inches possible.'}, {'number': 6, 'name': 'Wednesday Night', 'startTime': '2023-11-08T18:00:00-07:00', 'endTime': '2023-11-09T06:00:00-07:00', 'isDaytime': False, 'temperature': 18, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 60}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -7.777777777777778}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 87}, 'windSpeed': '0 to 5 mph', 'windDirection': 'ENE', 'icon': 'https://api.weather.gov/icons/land/night/snow,60?size=medium', 'shortForecast': 'Snow Showers Likely', 'detailedForecast': 'Snow showers likely. Mostly cloudy, with a low around 18. Chance of precipitation is 60%. New snow accumulation of 2 to 4 inches possible.'}]"] <context> 
2023-11-06 08:52:46,941 - INFO - User query: what is the weather a vail mountain tomorrow?
2023-11-06 08:52:51,158 - INFO - Method selected: weather_forecast
2023-11-06 08:52:51,776 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}, Output: None
2023-11-06 08:52:51,778 - ERROR - Error occurred: Expecting value: line 1 column 1 (char 0)
2023-11-06 08:52:51,779 - ERROR - Error occurred: 'NoneType' object is not subscriptable
2023-11-06 08:53:34,751 - INFO - User query: what is the weather a vail mountain tomorrow?
2023-11-06 08:53:34,755 - INFO - Method selected: weather_forecast
2023-11-06 08:53:34,756 - ERROR - Error occurred: Expecting value: line 1 column 1 (char 0)
2023-11-06 08:53:34,758 - ERROR - Error occurred: 'NoneType' object is not subscriptable
2023-11-06 08:54:24,903 - INFO - User query: what is the weather a vail mountain tomorrow?
2023-11-06 08:54:24,913 - INFO - Method selected: weather_forecast
2023-11-06 08:54:24,916 - ERROR - Error occurred: Expecting value: line 1 column 1 (char 0)
2023-11-06 08:54:24,917 - ERROR - Error occurred: 'NoneType' object is not subscriptable
2023-11-06 08:54:26,517 - INFO - File uploaded to gs://ask-bc-analytics/errors/2023-11-06_08-54-25.json
2023-11-06 08:57:27,370 - INFO - User query: what is the weather a vail mountain tomorrow?
2023-11-06 08:57:27,377 - INFO - Method selected: weather_forecast
2023-11-06 08:57:27,378 - ERROR - Error occurred: Expecting value: line 1 column 1 (char 0)
2023-11-06 08:57:27,381 - ERROR - An error occurred:
Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/app.py", line 77, in <module>
    lat = user_question.location['latitude']
TypeError: 'NoneType' object is not subscriptable
2023-11-06 08:57:27,387 - ERROR - Error occurred: 'NoneType' object is not subscriptable
2023-11-06 08:57:28,866 - INFO - File uploaded to gs://ask-bc-analytics/errors/2023-11-06_08-57-28.json
2023-11-06 09:00:37,307 - INFO - User query: what is the weather a vail mountain tomorrow?
2023-11-06 09:00:37,319 - INFO - Method selected: weather_forecast
2023-11-06 09:00:37,321 - ERROR - Error occurred: Expecting value: line 1 column 1 (char 0)
2023-11-06 09:00:37,323 - ERROR - An error occurred:
Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/app.py", line 78, in <module>
    lat = user_question.location['latitude']
TypeError: 'NoneType' object is not subscriptable
2023-11-06 09:00:37,324 - ERROR - Error occurred: 'NoneType' object is not subscriptable
2023-11-06 09:00:38,917 - INFO - File uploaded to gs://ask-bc-analytics/errors/2023-11-06_09-00-38.json
2023-11-06 09:35:17,432 - INFO - User query: What is the weather a vail mountain tomorrow?
2023-11-06 09:35:17,450 - INFO - Method selected: weather_forecast
2023-11-06 09:36:43,244 - INFO - User query: What is the weather a vail mountain tomorrow?
2023-11-06 09:36:43,249 - INFO - Method selected: weather_forecast
2023-11-06 09:36:44,317 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}, Output: None
2023-11-06 09:36:44,320 - ERROR - Error occurred: Expecting value: line 1 column 1 (char 0)
2023-11-06 09:36:44,322 - ERROR - An error occurred:
Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/app.py", line 79, in <module>
    lat = user_question.location['latitude']
TypeError: 'NoneType' object is not subscriptable
2023-11-06 09:36:44,322 - ERROR - Error occurred: 'NoneType' object is not subscriptable
2023-11-06 09:36:45,753 - INFO - File uploaded to gs://ask-bc-analytics/errors/2023-11-06_09-36-45-074.json
2023-11-06 10:39:34,490 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 10:39:37,656 - INFO - Method selected: snow_depth_data
2023-11-06 10:39:41,725 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}, Output: {"county": "Clear Creek", "state": "CO", "elevation": 11314, "latitude": 39.7972, "longitude": -105.7778}
2023-11-06 10:39:57,728 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 10:40:01,585 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_10-40-00-980.json
2023-11-06 10:40:01,590 - INFO - Generating response - System Context: You are a helpful assistant. Answer the user question based on the context below. Consider summarizing the context. <context> [[{'average_snow_depth': 6.0}]] <context> 
2023-11-06 10:40:05,814 - INFO - File uploaded to gs://ask-bc-analytics/feedback/2023-11-06_10-40-05-237.json
2023-11-06 10:42:30,422 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 10:42:30,436 - INFO - Method selected: snow_depth_data
2023-11-06 10:42:30,449 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 10:42:31,818 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_10-42-31-235.json
2023-11-06 10:45:42,339 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 10:45:42,356 - INFO - Method selected: snow_depth_data
2023-11-06 10:45:42,365 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 10:45:43,856 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_10-45-43-147.json
2023-11-06 10:49:41,664 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 10:49:41,677 - INFO - Method selected: snow_depth_data
2023-11-06 10:49:41,696 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 10:49:43,081 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_10-49-42-500.json
2023-11-06 10:50:49,353 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 10:50:49,366 - INFO - Method selected: snow_depth_data
2023-11-06 10:50:49,369 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 10:50:50,728 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_10-50-50-208.json
2023-11-06 10:53:52,765 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 10:53:52,773 - INFO - Method selected: snow_depth_data
2023-11-06 10:53:52,778 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 10:53:54,269 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_10-53-53-608.json
2023-11-06 10:54:05,973 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 10:54:05,977 - INFO - Method selected: snow_depth_data
2023-11-06 10:54:05,983 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 10:54:07,276 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_10-54-06-755.json
2023-11-06 10:55:24,818 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 10:55:24,824 - INFO - Method selected: snow_depth_data
2023-11-06 10:55:24,832 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 10:55:26,227 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_10-55-25-578.json
2023-11-06 10:57:28,792 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 10:57:28,801 - INFO - Method selected: snow_depth_data
2023-11-06 10:57:28,805 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 10:57:30,138 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_10-57-29-564.json
2023-11-06 10:59:46,160 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 10:59:46,165 - INFO - Method selected: snow_depth_data
2023-11-06 10:59:46,168 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 10:59:47,459 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_10-59-46-962.json
2023-11-06 11:00:27,122 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 11:00:27,127 - INFO - Method selected: snow_depth_data
2023-11-06 11:00:27,131 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 11:00:28,464 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_11-00-27-879.json
2023-11-06 11:03:42,863 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 11:03:46,057 - INFO - Method selected: snow_depth_data
2023-11-06 11:03:50,153 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}, Output: {"county": "Clear Creek", "state": "CO", "elevation": 11314, "latitude": 39.7972, "longitude": -105.7778}
2023-11-06 11:04:01,406 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 11:04:05,093 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_11-04-04-577.json
2023-11-06 11:04:05,095 - INFO - Generating response - System Context: You are a helpful assistant. Answer the user question based on the context below. Consider summarizing the context. <context> [[{'average_snow_depth': 6.0}]] <context> 
2023-11-06 13:56:17,162 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 13:56:17,175 - INFO - Method selected: snow_depth_data
2023-11-06 13:56:30,270 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 13:56:34,287 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_13-56-33-684.json
2023-11-06 13:56:34,294 - INFO - Generating response - System Context: You are a helpful assistant. Answer the user question based on the context below. Consider summarizing the context. <context> [[{'average_snow_depth': 6.0}]] <context> 
2023-11-06 14:04:48,686 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 14:04:48,691 - INFO - Method selected: snow_depth_data
2023-11-06 14:04:48,694 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 14:04:50,079 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_14-04-49-441.json
2023-11-06 14:08:37,865 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 14:08:37,873 - INFO - Method selected: snow_depth_data
2023-11-06 14:08:37,876 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 14:08:39,354 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_14-08-38-643.json
2023-11-06 14:08:39,360 - ERROR - An error occurred:
Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/app.py", line 106, in <module>
    kwargs={'bucket_name': 'ask-bc-analytics', 'destination_blob_name': 'feedback', 'contents': feedback}
NameError: name 'feedback' is not defined
2023-11-06 14:08:39,364 - ERROR - Error occurred: name 'feedback' is not defined
2023-11-06 14:08:40,684 - INFO - File uploaded to gs://ask-bc-analytics/errors/2023-11-06_14-08-40-088.json
2023-11-06 14:09:39,574 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 14:09:39,579 - INFO - Method selected: snow_depth_data
2023-11-06 14:09:39,584 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 14:09:41,209 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_14-09-40-461.json
2023-11-06 14:15:52,530 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 14:15:52,537 - INFO - Method selected: snow_depth_data
2023-11-06 14:15:52,545 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 14:15:54,158 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_14-15-53-283.json
2023-11-06 14:17:50,390 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 14:17:50,396 - INFO - Method selected: snow_depth_data
2023-11-06 14:17:50,402 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 14:17:52,217 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_14-17-51-225.json
2023-11-06 14:20:12,440 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 14:20:12,446 - INFO - Method selected: snow_depth_data
2023-11-06 14:20:12,449 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 14:20:14,246 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_14-20-13-263.json
2023-11-06 14:24:48,100 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 14:24:48,106 - INFO - Method selected: snow_depth_data
2023-11-06 14:24:48,110 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 14:24:49,604 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_14-24-48-866.json
2023-11-06 14:25:57,852 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 14:25:57,858 - INFO - Method selected: snow_depth_data
2023-11-06 14:25:57,864 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 14:25:59,430 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_14-25-58-749.json
2023-11-06 14:25:59,434 - ERROR - An error occurred:
Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/app.py", line 103, in <module>
    st.button("Good Answer", type="primary", on_click=asyncio.run(upload_blob_from_memory),
  File "/usr/lib/python3.10/asyncio/runners.py", line 37, in run
    raise ValueError("a coroutine was expected, got {!r}".format(main))
ValueError: a coroutine was expected, got <function upload_blob_from_memory at 0x7f9f542157e0>
2023-11-06 14:25:59,436 - ERROR - Error occurred: a coroutine was expected, got <function upload_blob_from_memory at 0x7f9f542157e0>
2023-11-06 14:26:00,926 - INFO - File uploaded to gs://ask-bc-analytics/errors/2023-11-06_14-26-00-300.json
2023-11-06 14:26:44,001 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 14:26:44,006 - INFO - Method selected: snow_depth_data
2023-11-06 14:26:44,010 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 14:26:45,538 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_14-26-44-899.json
2023-11-06 14:26:45,542 - ERROR - An error occurred:
Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/app.py", line 91, in <module>
    asyncio.run(
  File "/usr/lib/python3.10/asyncio/runners.py", line 37, in run
    raise ValueError("a coroutine was expected, got {!r}".format(main))
ValueError: a coroutine was expected, got None
2023-11-06 14:26:45,546 - ERROR - Error occurred: a coroutine was expected, got None
2023-11-06 14:26:46,986 - INFO - File uploaded to gs://ask-bc-analytics/errors/2023-11-06_14-26-46-292.json
2023-11-06 14:27:54,956 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 14:27:54,971 - INFO - Method selected: snow_depth_data
2023-11-06 14:27:55,007 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 14:27:56,530 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_14-27-55-839.json
2023-11-06 14:29:37,748 - INFO - User query: How much snow is at Berthoud Pass?
2023-11-06 14:29:37,753 - INFO - Method selected: snow_depth_data
2023-11-06 14:29:37,757 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(Date) AS max_date
  FROM `avalanche-analytics-project.historical_raw.snow-depth`
  WHERE county = 'Clear Creek' AND state = 'CO' AND elevation > 8314
)

SELECT AVG(snow_depth) AS average_snow_depth
FROM `avalanche-analytics-project.historical_raw.snow-depth` AS s
JOIN LatestDate AS ld
ON s.Date = ld.max_date
WHERE s.county = 'Clear Creek' AND s.state = 'CO' AND s.elevation > 8314
LIMIT 1;
2023-11-06 14:29:39,274 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_14-29-38-546.json
2023-11-06 14:29:42,625 - INFO - File uploaded to gs://ask-bc-analytics/feedback/2023-11-06_14-29-42-029.json
2023-11-06 17:48:18,916 - INFO - User query: What is the weather forecast for zip code 81632?
2023-11-06 17:48:23,385 - INFO - Method selected: weather_forecast
2023-11-06 17:48:24,818 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}, Output: None
2023-11-06 17:48:24,828 - ERROR - Error occurred: Expecting value: line 1 column 1 (char 0)
2023-11-06 17:48:24,832 - ERROR - An error occurred:
Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/app.py", line 88, in <module>
    lat = user_question.location['latitude']
TypeError: 'NoneType' object is not subscriptable
2023-11-06 17:48:24,834 - ERROR - Error occurred: 'NoneType' object is not subscriptable
2023-11-06 17:48:26,665 - INFO - File uploaded to gs://ask-bc-analytics/errors/2023-11-06_17-48-26-056.json
2023-11-06 17:49:49,445 - INFO - User query: What is the weather forecast for zip code 81632?
2023-11-06 17:49:56,371 - INFO - Method selected: weather_forecast
2023-11-06 17:49:56,916 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}, Output: None
2023-11-06 17:49:56,918 - ERROR - Error occurred: Expecting value: line 1 column 1 (char 0)
2023-11-06 17:49:56,919 - ERROR - An error occurred:
Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/app.py", line 88, in <module>
    lat = user_question.location['latitude']
TypeError: 'NoneType' object is not subscriptable
2023-11-06 17:49:56,920 - ERROR - Error occurred: 'NoneType' object is not subscriptable
2023-11-06 17:49:58,101 - INFO - File uploaded to gs://ask-bc-analytics/errors/2023-11-06_17-49-57-592.json
2023-11-06 17:52:43,763 - INFO - User query: What is the weather forecast for Vail Mountain, CO?
2023-11-06 17:52:45,836 - INFO - Method selected: weather_forecast
2023-11-06 17:52:49,623 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}, Output: {"county": "Eagle", "state": "CO", "elevation": 11250, "latitude": 39.6403, "longitude": -106.3742}
2023-11-06 17:52:49,633 - INFO - Getting weather_forecast for Latitude: 39.6403, Longitude: -106.3742
2023-11-06 17:52:52,290 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_17-52-51-587.json
2023-11-06 17:52:52,296 - INFO - Generating response - System Context: You are a helpful assistant. Answer the user question based on the context below. Consider summarizing the context. <context> ["Forecast: [{'number': 1, 'name': 'This Afternoon', 'startTime': '2023-11-06T17:00:00-07:00', 'endTime': '2023-11-06T18:00:00-07:00', 'isDaytime': True, 'temperature': 55, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -7.222222222222222}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 33}, 'windSpeed': '10 mph', 'windDirection': 'W', 'icon': 'https://api.weather.gov/icons/land/day/sct?size=medium', 'shortForecast': 'Mostly Sunny', 'detailedForecast': 'Mostly sunny, with a high near 55. West wind around 10 mph, with gusts as high as 25 mph.'}, {'number': 2, 'name': 'Tonight', 'startTime': '2023-11-06T18:00:00-07:00', 'endTime': '2023-11-07T06:00:00-07:00', 'isDaytime': False, 'temperature': 31, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -6.666666666666667}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 52}, 'windSpeed': '10 to 20 mph', 'windDirection': 'WSW', 'icon': 'https://api.weather.gov/icons/land/night/few?size=medium', 'shortForecast': 'Mostly Clear', 'detailedForecast': 'Mostly clear, with a low around 31. West southwest wind 10 to 20 mph, with gusts as high as 35 mph.'}, {'number': 3, 'name': 'Tuesday', 'startTime': '2023-11-07T06:00:00-07:00', 'endTime': '2023-11-07T18:00:00-07:00', 'isDaytime': True, 'temperature': 54, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -6.111111111111111}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 52}, 'windSpeed': '20 to 30 mph', 'windDirection': 'WSW', 'icon': 'https://api.weather.gov/icons/land/day/wind_few?size=medium', 'shortForecast': 'Sunny', 'detailedForecast': 'Sunny, with a high near 54. West southwest wind 20 to 30 mph, with gusts as high as 45 mph.'}, {'number': 4, 'name': 'Tuesday Night', 'startTime': '2023-11-07T18:00:00-07:00', 'endTime': '2023-11-08T06:00:00-07:00', 'isDaytime': False, 'temperature': 26, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 70}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -3.3333333333333335}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 88}, 'windSpeed': '5 to 20 mph', 'windDirection': 'W', 'icon': 'https://api.weather.gov/icons/land/night/snow,40/snow,70?size=medium', 'shortForecast': 'Snow Showers Likely', 'detailedForecast': 'Snow showers likely after 11pm. Mostly cloudy, with a low around 26. West wind 5 to 20 mph. Chance of precipitation is 70%. New snow accumulation of 1 to 2 inches possible.'}, {'number': 5, 'name': 'Wednesday', 'startTime': '2023-11-08T06:00:00-07:00', 'endTime': '2023-11-08T18:00:00-07:00', 'isDaytime': True, 'temperature': 38, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 70}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -3.888888888888889}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 87}, 'windSpeed': '5 to 10 mph', 'windDirection': 'NW', 'icon': 'https://api.weather.gov/icons/land/day/snow,70/snow,60?size=medium', 'shortForecast': 'Snow Showers Likely', 'detailedForecast': 'Snow showers likely. Mostly cloudy, with a high near 38. Northwest wind 5 to 10 mph. Chance of precipitation is 70%. New snow accumulation of 1 to 3 inches possible.'}, {'number': 6, 'name': 'Wednesday Night', 'startTime': '2023-11-08T18:00:00-07:00', 'endTime': '2023-11-09T06:00:00-07:00', 'isDaytime': False, 'temperature': 19, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 60}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -7.222222222222222}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 79}, 'windSpeed': '0 to 5 mph', 'windDirection': 'NE', 'icon': 'https://api.weather.gov/icons/land/night/snow,60?size=medium', 'shortForecast': 'Snow Showers Likely', 'detailedForecast': 'Snow showers likely. Mostly cloudy, with a low around 19. Chance of precipitation is 60%. New snow accumulation of 1 to 3 inches possible.'}]"] <context> 
2023-11-06 17:56:23,882 - INFO - User query: What is the weather forecast for 81632?
2023-11-06 17:56:27,439 - INFO - Method selected: weather_forecast
2023-11-06 17:56:28,249 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}, Output: None
2023-11-06 17:56:28,253 - ERROR - Error occurred: Expecting value: line 1 column 1 (char 0)
2023-11-06 17:56:28,256 - ERROR - An error occurred:
Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/app.py", line 88, in <module>
    lat = user_question.location['latitude']
TypeError: 'NoneType' object is not subscriptable
2023-11-06 17:56:28,258 - ERROR - Error occurred: 'NoneType' object is not subscriptable
2023-11-06 17:56:29,579 - INFO - File uploaded to gs://ask-bc-analytics/errors/2023-11-06_17-56-28-997.json
2023-11-06 17:58:54,520 - INFO - User query: What is the weather forecast for 81620?
2023-11-06 17:58:58,269 - INFO - Method selected: weather_forecast
2023-11-06 17:59:01,237 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Eagle", "state": "CO", "elevation": 7418, "latitude": 39.6042, "longitude": -106.5167}
2023-11-06 17:59:01,246 - INFO - Getting weather_forecast for Latitude: 39.6042, Longitude: -106.5167
2023-11-06 17:59:03,565 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_17-59-02-904.json
2023-11-06 17:59:03,569 - INFO - Generating response - System Context: You are a helpful assistant. Answer the user question based on the context below. Consider summarizing the context. <context> ["Forecast: [{'number': 1, 'name': 'This Afternoon', 'startTime': '2023-11-06T17:00:00-07:00', 'endTime': '2023-11-06T18:00:00-07:00', 'isDaytime': True, 'temperature': 57, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -7.777777777777778}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 29}, 'windSpeed': '10 mph', 'windDirection': 'W', 'icon': 'https://api.weather.gov/icons/land/day/sct?size=medium', 'shortForecast': 'Mostly Sunny', 'detailedForecast': 'Mostly sunny, with a high near 57. West wind around 10 mph, with gusts as high as 30 mph.'}, {'number': 2, 'name': 'Tonight', 'startTime': '2023-11-06T18:00:00-07:00', 'endTime': '2023-11-07T06:00:00-07:00', 'isDaytime': False, 'temperature': 32, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -6.111111111111111}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 54}, 'windSpeed': '15 to 20 mph', 'windDirection': 'SW', 'icon': 'https://api.weather.gov/icons/land/night/few?size=medium', 'shortForecast': 'Mostly Clear', 'detailedForecast': 'Mostly clear, with a low around 32. Southwest wind 15 to 20 mph, with gusts as high as 35 mph.'}, {'number': 3, 'name': 'Tuesday', 'startTime': '2023-11-07T06:00:00-07:00', 'endTime': '2023-11-07T18:00:00-07:00', 'isDaytime': True, 'temperature': 54, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 20}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -5.555555555555555}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 56}, 'windSpeed': '20 to 30 mph', 'windDirection': 'WSW', 'icon': 'https://api.weather.gov/icons/land/day/wind_sct/snow,20?size=medium', 'shortForecast': 'Mostly Sunny then Slight Chance Rain And Snow Showers', 'detailedForecast': 'A slight chance of rain and snow showers after 5pm. Mostly sunny, with a high near 54. West southwest wind 20 to 30 mph, with gusts as high as 45 mph. Chance of precipitation is 20%.'}, {'number': 4, 'name': 'Tuesday Night', 'startTime': '2023-11-07T18:00:00-07:00', 'endTime': '2023-11-08T06:00:00-07:00', 'isDaytime': False, 'temperature': 27, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 60}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -2.2222222222222223}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 100}, 'windSpeed': '5 to 20 mph', 'windDirection': 'W', 'icon': 'https://api.weather.gov/icons/land/night/snow,40/snow,60?size=medium', 'shortForecast': 'Rain And Snow Showers Likely', 'detailedForecast': 'Rain and snow showers likely. Mostly cloudy, with a low around 27. West wind 5 to 20 mph. Chance of precipitation is 60%. New snow accumulation of around one inch possible.'}, {'number': 5, 'name': 'Wednesday', 'startTime': '2023-11-08T06:00:00-07:00', 'endTime': '2023-11-08T18:00:00-07:00', 'isDaytime': True, 'temperature': 38, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 60}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -2.7777777777777777}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 98}, 'windSpeed': '5 to 10 mph', 'windDirection': 'NW', 'icon': 'https://api.weather.gov/icons/land/day/snow,60/snow,50?size=medium', 'shortForecast': 'Snow Showers Likely', 'detailedForecast': 'Snow showers likely. Mostly cloudy, with a high near 38. Northwest wind 5 to 10 mph. Chance of precipitation is 60%. New snow accumulation of 1 to 2 inches possible.'}, {'number': 6, 'name': 'Wednesday Night', 'startTime': '2023-11-08T18:00:00-07:00', 'endTime': '2023-11-09T06:00:00-07:00', 'isDaytime': False, 'temperature': 19, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 60}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -6.666666666666667}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 84}, 'windSpeed': '0 to 5 mph', 'windDirection': 'NE', 'icon': 'https://api.weather.gov/icons/land/night/snow,60?size=medium', 'shortForecast': 'Snow Showers Likely', 'detailedForecast': 'Snow showers likely. Mostly cloudy, with a low around 19. Chance of precipitation is 60%. New snow accumulation of around one inch possible.'}]"] <context> 
2023-11-06 17:59:54,189 - INFO - User query: What is the weather forecast for 60091?
2023-11-06 17:59:57,807 - INFO - Method selected: weather_forecast
2023-11-06 18:00:00,887 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Cook", "state": "IL", "elevation": 620, "latitude": 42.0751, "longitude": -87.7228}
2023-11-06 18:00:00,890 - INFO - Getting weather_forecast for Latitude: 42.0751, Longitude: -87.7228
2023-11-06 18:00:03,292 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_18-00-02-665.json
2023-11-06 18:00:03,299 - INFO - Generating response - System Context: You are a helpful assistant. Answer the user question based on the context below. Consider summarizing the context. <context> ["Forecast: [{'number': 1, 'name': 'Tonight', 'startTime': '2023-11-06T18:00:00-06:00', 'endTime': '2023-11-07T06:00:00-06:00', 'isDaytime': False, 'temperature': 43, 'temperatureUnit': 'F', 'temperatureTrend': 'rising', 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 8.88888888888889}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 82}, 'windSpeed': '10 mph', 'windDirection': 'WNW', 'icon': 'https://api.weather.gov/icons/land/night/sct?size=medium', 'shortForecast': 'Partly Cloudy', 'detailedForecast': 'Partly cloudy. Low around 43, with temperatures rising to around 45 overnight. West northwest wind around 10 mph, with gusts as high as 25 mph.'}, {'number': 2, 'name': 'Tuesday', 'startTime': '2023-11-07T06:00:00-06:00', 'endTime': '2023-11-07T18:00:00-06:00', 'isDaytime': True, 'temperature': 52, 'temperatureUnit': 'F', 'temperatureTrend': 'falling', 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 6.111111111111111}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 86}, 'windSpeed': '5 to 10 mph', 'windDirection': 'NNE', 'icon': 'https://api.weather.gov/icons/land/day/bkn?size=medium', 'shortForecast': 'Partly Sunny', 'detailedForecast': 'Partly sunny. High near 52, with temperatures falling to around 48 in the afternoon. North northeast wind 5 to 10 mph.'}, {'number': 3, 'name': 'Tuesday Night', 'startTime': '2023-11-07T18:00:00-06:00', 'endTime': '2023-11-08T06:00:00-06:00', 'isDaytime': False, 'temperature': 45, 'temperatureUnit': 'F', 'temperatureTrend': 'rising', 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 30}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 6.666666666666667}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 89}, 'windSpeed': '10 to 15 mph', 'windDirection': 'E', 'icon': 'https://api.weather.gov/icons/land/night/bkn/rain,30?size=medium', 'shortForecast': 'Mostly Cloudy then Chance Rain', 'detailedForecast': 'A chance of rain after midnight. Mostly cloudy. Low around 45, with temperatures rising to around 48 overnight. East wind 10 to 15 mph. Chance of precipitation is 30%. New rainfall amounts less than a tenth of an inch possible.'}, {'number': 4, 'name': 'Wednesday', 'startTime': '2023-11-08T06:00:00-06:00', 'endTime': '2023-11-08T18:00:00-06:00', 'isDaytime': True, 'temperature': 58, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 50}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 11.666666666666666}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 93}, 'windSpeed': '5 to 10 mph', 'windDirection': 'E', 'icon': 'https://api.weather.gov/icons/land/day/rain,40/rain,50?size=medium', 'shortForecast': 'Chance Rain', 'detailedForecast': 'A chance of rain. Cloudy, with a high near 58. East wind 5 to 10 mph, with gusts as high as 20 mph. Chance of precipitation is 50%.'}, {'number': 5, 'name': 'Wednesday Night', 'startTime': '2023-11-08T18:00:00-06:00', 'endTime': '2023-11-09T06:00:00-06:00', 'isDaytime': False, 'temperature': 44, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 40}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 11.666666666666666}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 96}, 'windSpeed': '5 to 15 mph', 'windDirection': 'N', 'icon': 'https://api.weather.gov/icons/land/night/rain,40/bkn?size=medium', 'shortForecast': 'Chance Rain then Mostly Cloudy', 'detailedForecast': 'A chance of rain before midnight. Mostly cloudy, with a low around 44. North wind 5 to 15 mph. Chance of precipitation is 40%.'}, {'number': 6, 'name': 'Thursday', 'startTime': '2023-11-09T06:00:00-06:00', 'endTime': '2023-11-09T18:00:00-06:00', 'isDaytime': True, 'temperature': 51, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 5.555555555555555}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 86}, 'windSpeed': '15 mph', 'windDirection': 'WNW', 'icon': 'https://api.weather.gov/icons/land/day/sct?size=medium', 'shortForecast': 'Mostly Sunny', 'detailedForecast': 'Mostly sunny, with a high near 51.'}]"] <context> 
2023-11-06 18:02:55,132 - INFO - User query: What is the weather forecast for 60091?
2023-11-06 18:02:58,500 - INFO - Method selected: weather_forecast
2023-11-06 18:03:02,799 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Cook", "state": "IL", "elevation": 620, "latitude": 42.0751, "longitude": -87.7228}
2023-11-06 18:03:02,801 - INFO - Getting weather_forecast for Latitude: 42.0751, Longitude: -87.7228
2023-11-06 18:03:04,643 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_18-03-03-953.json
2023-11-06 18:03:04,648 - INFO - Generating response - System Context: You are a helpful assistant. Answer the user question based on the context below. Consider summarizing the context. <context> ["Forecast: [{'number': 1, 'name': 'Tonight', 'startTime': '2023-11-06T18:00:00-06:00', 'endTime': '2023-11-07T06:00:00-06:00', 'isDaytime': False, 'temperature': 43, 'temperatureUnit': 'F', 'temperatureTrend': 'rising', 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 8.88888888888889}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 82}, 'windSpeed': '10 mph', 'windDirection': 'WNW', 'icon': 'https://api.weather.gov/icons/land/night/sct?size=medium', 'shortForecast': 'Partly Cloudy', 'detailedForecast': 'Partly cloudy. Low around 43, with temperatures rising to around 45 overnight. West northwest wind around 10 mph, with gusts as high as 25 mph.'}, {'number': 2, 'name': 'Tuesday', 'startTime': '2023-11-07T06:00:00-06:00', 'endTime': '2023-11-07T18:00:00-06:00', 'isDaytime': True, 'temperature': 52, 'temperatureUnit': 'F', 'temperatureTrend': 'falling', 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 6.111111111111111}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 86}, 'windSpeed': '5 to 10 mph', 'windDirection': 'NNE', 'icon': 'https://api.weather.gov/icons/land/day/bkn?size=medium', 'shortForecast': 'Partly Sunny', 'detailedForecast': 'Partly sunny. High near 52, with temperatures falling to around 48 in the afternoon. North northeast wind 5 to 10 mph.'}, {'number': 3, 'name': 'Tuesday Night', 'startTime': '2023-11-07T18:00:00-06:00', 'endTime': '2023-11-08T06:00:00-06:00', 'isDaytime': False, 'temperature': 45, 'temperatureUnit': 'F', 'temperatureTrend': 'rising', 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 30}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 6.666666666666667}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 89}, 'windSpeed': '10 to 15 mph', 'windDirection': 'E', 'icon': 'https://api.weather.gov/icons/land/night/bkn/rain,30?size=medium', 'shortForecast': 'Mostly Cloudy then Chance Rain', 'detailedForecast': 'A chance of rain after midnight. Mostly cloudy. Low around 45, with temperatures rising to around 48 overnight. East wind 10 to 15 mph. Chance of precipitation is 30%. New rainfall amounts less than a tenth of an inch possible.'}, {'number': 4, 'name': 'Wednesday', 'startTime': '2023-11-08T06:00:00-06:00', 'endTime': '2023-11-08T18:00:00-06:00', 'isDaytime': True, 'temperature': 58, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 50}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 11.666666666666666}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 93}, 'windSpeed': '5 to 10 mph', 'windDirection': 'E', 'icon': 'https://api.weather.gov/icons/land/day/rain,40/rain,50?size=medium', 'shortForecast': 'Chance Rain', 'detailedForecast': 'A chance of rain. Cloudy, with a high near 58. East wind 5 to 10 mph, with gusts as high as 20 mph. Chance of precipitation is 50%.'}, {'number': 5, 'name': 'Wednesday Night', 'startTime': '2023-11-08T18:00:00-06:00', 'endTime': '2023-11-09T06:00:00-06:00', 'isDaytime': False, 'temperature': 44, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 40}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 11.666666666666666}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 96}, 'windSpeed': '5 to 15 mph', 'windDirection': 'N', 'icon': 'https://api.weather.gov/icons/land/night/rain,40/bkn?size=medium', 'shortForecast': 'Chance Rain then Mostly Cloudy', 'detailedForecast': 'A chance of rain before midnight. Mostly cloudy, with a low around 44. North wind 5 to 15 mph. Chance of precipitation is 40%.'}, {'number': 6, 'name': 'Thursday', 'startTime': '2023-11-09T06:00:00-06:00', 'endTime': '2023-11-09T18:00:00-06:00', 'isDaytime': True, 'temperature': 51, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 5.555555555555555}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 86}, 'windSpeed': '15 mph', 'windDirection': 'WNW', 'icon': 'https://api.weather.gov/icons/land/day/sct?size=medium', 'shortForecast': 'Mostly Sunny', 'detailedForecast': 'Mostly sunny, with a high near 51.'}]"] <context> 
2023-11-06 18:05:02,823 - INFO - User query: What is the weather forecast for 60091?
2023-11-06 18:05:06,401 - ERROR - An error occurred:
Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 87, in get
    entry_bytes = self._read_from_mem_cache(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 137, in _read_from_mem_cache
    raise CacheStorageKeyNotFoundError("Key not found in mem cache")
streamlit.runtime.caching.storage.cache_storage_protocol.CacheStorageKeyNotFoundError: Key not found in mem cache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/local_disk_cache_storage.py", line 145, in get
    with streamlit_read(path, binary=True) as input:
  File "/usr/lib/python3.10/contextlib.py", line 135, in __enter__
    return next(self.gen)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/file_util.py", line 77, in streamlit_read
    if os.stat(filename).st_size == 0:
FileNotFoundError: [Errno 2] No such file or directory: '/home/max/.streamlit/cache/b88086d47b4148ca032c0dd51c5a6cb2-b77c05d936d16a2dc7df4df4b08d28c4.memo'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_data_api.py", line 634, in read_result
    pickled_entry = self.storage.get(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 89, in get
    entry_bytes = self._persist_storage.get(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/local_disk_cache_storage.py", line 150, in get
    raise CacheStorageKeyNotFoundError("Key not found in disk cache")
streamlit.runtime.caching.storage.cache_storage_protocol.CacheStorageKeyNotFoundError: Key not found in disk cache

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 264, in _get_or_create_cached_value
    cached_result = cache.read_result(value_key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_data_api.py", line 636, in read_result
    raise CacheKeyNotFoundError(str(e)) from e
streamlit.runtime.caching.cache_errors.CacheKeyNotFoundError: Key not found in disk cache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 87, in get
    entry_bytes = self._read_from_mem_cache(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 137, in _read_from_mem_cache
    raise CacheStorageKeyNotFoundError("Key not found in mem cache")
streamlit.runtime.caching.storage.cache_storage_protocol.CacheStorageKeyNotFoundError: Key not found in mem cache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/local_disk_cache_storage.py", line 145, in get
    with streamlit_read(path, binary=True) as input:
  File "/usr/lib/python3.10/contextlib.py", line 135, in __enter__
    return next(self.gen)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/file_util.py", line 77, in streamlit_read
    if os.stat(filename).st_size == 0:
FileNotFoundError: [Errno 2] No such file or directory: '/home/max/.streamlit/cache/b88086d47b4148ca032c0dd51c5a6cb2-b77c05d936d16a2dc7df4df4b08d28c4.memo'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_data_api.py", line 634, in read_result
    pickled_entry = self.storage.get(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 89, in get
    entry_bytes = self._persist_storage.get(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/local_disk_cache_storage.py", line 150, in get
    raise CacheStorageKeyNotFoundError("Key not found in disk cache")
streamlit.runtime.caching.storage.cache_storage_protocol.CacheStorageKeyNotFoundError: Key not found in disk cache

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 312, in _handle_cache_miss
    cached_result = cache.read_result(value_key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_data_api.py", line 636, in read_result
    raise CacheKeyNotFoundError(str(e)) from e
streamlit.runtime.caching.cache_errors.CacheKeyNotFoundError: Key not found in disk cache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/app.py", line 64, in <module>
    user_question.method = method_selector(user_question.question)  # Collect data for the user question
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 212, in wrapper
    return cached_func(*args, **kwargs)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 243, in __call__
    return self._get_or_create_cached_value(args, kwargs)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 267, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 321, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "/home/max/PycharmProjects/askbc-backend/helpers/UserQuestion.py", line 107, in method_selector
    return response["choices"][0]["message"]["function_call"]['name']
KeyError: 'function_call'
2023-11-06 18:05:06,438 - ERROR - Error occurred: 'function_call'
2023-11-06 18:05:07,627 - INFO - File uploaded to gs://ask-bc-analytics/errors/2023-11-06_18-05-07-098.json
2023-11-06 18:06:36,134 - INFO - User query: What is the weather forecast for 60091?
2023-11-06 18:06:41,837 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'What is the weather forecast for 60091?'}], Output: {
  "id": "chatcmpl-8I4q423l8HPwg0rShmVrY1soJINTG",
  "object": "chat.completion",
  "created": 1699319196,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, let me fetch the weather forecast for you.",
        "function_call": {
          "name": "weather_forecast",
          "arguments": "{\n  \"latitude\": \"42.0751\",\n  \"longitude\": \"-87.7228\"\n}"
        }
      },
      "finish_reason": "function_call"
    }
  ],
  "usage": {
    "prompt_tokens": 185,
    "completion_tokens": 41,
    "total_tokens": 226
  }
}
2023-11-06 18:06:41,841 - INFO - Method selected: weather_forecast
2023-11-06 18:06:44,806 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Cook", "state": "IL", "elevation": 620, "latitude": 42.0751, "longitude": -87.7228}
2023-11-06 18:06:44,813 - INFO - Getting weather_forecast for Latitude: 42.0751, Longitude: -87.7228
2023-11-06 18:06:46,650 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_18-06-46-040.json
2023-11-06 18:06:46,654 - INFO - Generating response - System Context: You are a helpful assistant. Answer the user question based on the context below. Consider summarizing the context. The context is always related to entities in the question.<context> ["Forecast: [{'number': 1, 'name': 'Tonight', 'startTime': '2023-11-06T18:00:00-06:00', 'endTime': '2023-11-07T06:00:00-06:00', 'isDaytime': False, 'temperature': 43, 'temperatureUnit': 'F', 'temperatureTrend': 'rising', 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 8.88888888888889}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 82}, 'windSpeed': '10 mph', 'windDirection': 'WNW', 'icon': 'https://api.weather.gov/icons/land/night/sct?size=medium', 'shortForecast': 'Partly Cloudy', 'detailedForecast': 'Partly cloudy. Low around 43, with temperatures rising to around 45 overnight. West northwest wind around 10 mph, with gusts as high as 25 mph.'}, {'number': 2, 'name': 'Tuesday', 'startTime': '2023-11-07T06:00:00-06:00', 'endTime': '2023-11-07T18:00:00-06:00', 'isDaytime': True, 'temperature': 52, 'temperatureUnit': 'F', 'temperatureTrend': 'falling', 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 6.111111111111111}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 86}, 'windSpeed': '5 to 10 mph', 'windDirection': 'NNE', 'icon': 'https://api.weather.gov/icons/land/day/bkn?size=medium', 'shortForecast': 'Partly Sunny', 'detailedForecast': 'Partly sunny. High near 52, with temperatures falling to around 48 in the afternoon. North northeast wind 5 to 10 mph.'}, {'number': 3, 'name': 'Tuesday Night', 'startTime': '2023-11-07T18:00:00-06:00', 'endTime': '2023-11-08T06:00:00-06:00', 'isDaytime': False, 'temperature': 45, 'temperatureUnit': 'F', 'temperatureTrend': 'rising', 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 30}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 6.666666666666667}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 89}, 'windSpeed': '10 to 15 mph', 'windDirection': 'E', 'icon': 'https://api.weather.gov/icons/land/night/bkn/rain,30?size=medium', 'shortForecast': 'Mostly Cloudy then Chance Rain', 'detailedForecast': 'A chance of rain after midnight. Mostly cloudy. Low around 45, with temperatures rising to around 48 overnight. East wind 10 to 15 mph. Chance of precipitation is 30%. New rainfall amounts less than a tenth of an inch possible.'}, {'number': 4, 'name': 'Wednesday', 'startTime': '2023-11-08T06:00:00-06:00', 'endTime': '2023-11-08T18:00:00-06:00', 'isDaytime': True, 'temperature': 58, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 50}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 11.666666666666666}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 93}, 'windSpeed': '5 to 10 mph', 'windDirection': 'E', 'icon': 'https://api.weather.gov/icons/land/day/rain,40/rain,50?size=medium', 'shortForecast': 'Chance Rain', 'detailedForecast': 'A chance of rain. Cloudy, with a high near 58. East wind 5 to 10 mph, with gusts as high as 20 mph. Chance of precipitation is 50%.'}, {'number': 5, 'name': 'Wednesday Night', 'startTime': '2023-11-08T18:00:00-06:00', 'endTime': '2023-11-09T06:00:00-06:00', 'isDaytime': False, 'temperature': 44, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 40}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 11.666666666666666}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 96}, 'windSpeed': '5 to 15 mph', 'windDirection': 'N', 'icon': 'https://api.weather.gov/icons/land/night/rain,40/bkn?size=medium', 'shortForecast': 'Chance Rain then Mostly Cloudy', 'detailedForecast': 'A chance of rain before midnight. Mostly cloudy, with a low around 44. North wind 5 to 15 mph. Chance of precipitation is 40%.'}, {'number': 6, 'name': 'Thursday', 'startTime': '2023-11-09T06:00:00-06:00', 'endTime': '2023-11-09T18:00:00-06:00', 'isDaytime': True, 'temperature': 51, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 5.555555555555555}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 86}, 'windSpeed': '15 mph', 'windDirection': 'WNW', 'icon': 'https://api.weather.gov/icons/land/day/sct?size=medium', 'shortForecast': 'Mostly Sunny', 'detailedForecast': 'Mostly sunny, with a high near 51.'}]"] <context> 
2023-11-06 18:08:45,946 - INFO - File uploaded to gs://ask-bc-analytics/feedback/2023-11-06_18-08-45-394.json
2023-11-06 18:09:05,976 - INFO - User query: What is the weather forecast for 60091?
2023-11-06 18:09:09,350 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'What is the weather forecast for 60091?'}], Output: {
  "id": "chatcmpl-8I4sUL0R2boj7iu7Epc8XysRduUNW",
  "object": "chat.completion",
  "created": 1699319346,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "I'm sorry, but I need the latitude and longitude to provide a weather forecast. Could you please provide those details?"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 185,
    "completion_tokens": 25,
    "total_tokens": 210
  }
}
2023-11-06 18:09:09,353 - ERROR - An error occurred:
Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 87, in get
    entry_bytes = self._read_from_mem_cache(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 137, in _read_from_mem_cache
    raise CacheStorageKeyNotFoundError("Key not found in mem cache")
streamlit.runtime.caching.storage.cache_storage_protocol.CacheStorageKeyNotFoundError: Key not found in mem cache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/local_disk_cache_storage.py", line 145, in get
    with streamlit_read(path, binary=True) as input:
  File "/usr/lib/python3.10/contextlib.py", line 135, in __enter__
    return next(self.gen)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/file_util.py", line 77, in streamlit_read
    if os.stat(filename).st_size == 0:
FileNotFoundError: [Errno 2] No such file or directory: '/home/max/.streamlit/cache/d4a49b96bb57319b6d01e9e86d8e04a0-b77c05d936d16a2dc7df4df4b08d28c4.memo'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_data_api.py", line 634, in read_result
    pickled_entry = self.storage.get(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 89, in get
    entry_bytes = self._persist_storage.get(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/local_disk_cache_storage.py", line 150, in get
    raise CacheStorageKeyNotFoundError("Key not found in disk cache")
streamlit.runtime.caching.storage.cache_storage_protocol.CacheStorageKeyNotFoundError: Key not found in disk cache

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 264, in _get_or_create_cached_value
    cached_result = cache.read_result(value_key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_data_api.py", line 636, in read_result
    raise CacheKeyNotFoundError(str(e)) from e
streamlit.runtime.caching.cache_errors.CacheKeyNotFoundError: Key not found in disk cache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 87, in get
    entry_bytes = self._read_from_mem_cache(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 137, in _read_from_mem_cache
    raise CacheStorageKeyNotFoundError("Key not found in mem cache")
streamlit.runtime.caching.storage.cache_storage_protocol.CacheStorageKeyNotFoundError: Key not found in mem cache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/local_disk_cache_storage.py", line 145, in get
    with streamlit_read(path, binary=True) as input:
  File "/usr/lib/python3.10/contextlib.py", line 135, in __enter__
    return next(self.gen)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/file_util.py", line 77, in streamlit_read
    if os.stat(filename).st_size == 0:
FileNotFoundError: [Errno 2] No such file or directory: '/home/max/.streamlit/cache/d4a49b96bb57319b6d01e9e86d8e04a0-b77c05d936d16a2dc7df4df4b08d28c4.memo'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_data_api.py", line 634, in read_result
    pickled_entry = self.storage.get(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 89, in get
    entry_bytes = self._persist_storage.get(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/local_disk_cache_storage.py", line 150, in get
    raise CacheStorageKeyNotFoundError("Key not found in disk cache")
streamlit.runtime.caching.storage.cache_storage_protocol.CacheStorageKeyNotFoundError: Key not found in disk cache

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 312, in _handle_cache_miss
    cached_result = cache.read_result(value_key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_data_api.py", line 636, in read_result
    raise CacheKeyNotFoundError(str(e)) from e
streamlit.runtime.caching.cache_errors.CacheKeyNotFoundError: Key not found in disk cache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/app.py", line 64, in <module>
    user_question.method = method_selector(user_question.question)  # Collect data for the user question
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 212, in wrapper
    return cached_func(*args, **kwargs)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 243, in __call__
    return self._get_or_create_cached_value(args, kwargs)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 267, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 321, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "/home/max/PycharmProjects/askbc-backend/helpers/UserQuestion.py", line 108, in method_selector
    return response["choices"][0]["message"]["function_call"]['name']
KeyError: 'function_call'
2023-11-06 18:09:09,424 - ERROR - Error occurred: 'function_call'
2023-11-06 18:09:10,625 - INFO - File uploaded to gs://ask-bc-analytics/errors/2023-11-06_18-09-10-089.json
2023-11-06 18:09:46,883 - INFO - User query: What is the weather forecast for 60091?
2023-11-06 18:09:51,070 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'What is the weather forecast for 60091?'}], Output: {
  "id": "chatcmpl-8I4t9iVCSmzPhMQxH5f1IdABPytdf",
  "object": "chat.completion",
  "created": 1699319387,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "I'm sorry, but I can't provide the weather forecast based on a postal code. Could you please provide the latitude and longitude of the location you're interested in?"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 185,
    "completion_tokens": 35,
    "total_tokens": 220
  }
}
2023-11-06 18:09:51,073 - ERROR - An error occurred:
Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 87, in get
    entry_bytes = self._read_from_mem_cache(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 137, in _read_from_mem_cache
    raise CacheStorageKeyNotFoundError("Key not found in mem cache")
streamlit.runtime.caching.storage.cache_storage_protocol.CacheStorageKeyNotFoundError: Key not found in mem cache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/local_disk_cache_storage.py", line 145, in get
    with streamlit_read(path, binary=True) as input:
  File "/usr/lib/python3.10/contextlib.py", line 135, in __enter__
    return next(self.gen)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/file_util.py", line 77, in streamlit_read
    if os.stat(filename).st_size == 0:
FileNotFoundError: [Errno 2] No such file or directory: '/home/max/.streamlit/cache/d4a49b96bb57319b6d01e9e86d8e04a0-b77c05d936d16a2dc7df4df4b08d28c4.memo'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_data_api.py", line 634, in read_result
    pickled_entry = self.storage.get(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 89, in get
    entry_bytes = self._persist_storage.get(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/local_disk_cache_storage.py", line 150, in get
    raise CacheStorageKeyNotFoundError("Key not found in disk cache")
streamlit.runtime.caching.storage.cache_storage_protocol.CacheStorageKeyNotFoundError: Key not found in disk cache

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 264, in _get_or_create_cached_value
    cached_result = cache.read_result(value_key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_data_api.py", line 636, in read_result
    raise CacheKeyNotFoundError(str(e)) from e
streamlit.runtime.caching.cache_errors.CacheKeyNotFoundError: Key not found in disk cache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 87, in get
    entry_bytes = self._read_from_mem_cache(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 137, in _read_from_mem_cache
    raise CacheStorageKeyNotFoundError("Key not found in mem cache")
streamlit.runtime.caching.storage.cache_storage_protocol.CacheStorageKeyNotFoundError: Key not found in mem cache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/local_disk_cache_storage.py", line 145, in get
    with streamlit_read(path, binary=True) as input:
  File "/usr/lib/python3.10/contextlib.py", line 135, in __enter__
    return next(self.gen)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/file_util.py", line 77, in streamlit_read
    if os.stat(filename).st_size == 0:
FileNotFoundError: [Errno 2] No such file or directory: '/home/max/.streamlit/cache/d4a49b96bb57319b6d01e9e86d8e04a0-b77c05d936d16a2dc7df4df4b08d28c4.memo'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_data_api.py", line 634, in read_result
    pickled_entry = self.storage.get(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 89, in get
    entry_bytes = self._persist_storage.get(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/local_disk_cache_storage.py", line 150, in get
    raise CacheStorageKeyNotFoundError("Key not found in disk cache")
streamlit.runtime.caching.storage.cache_storage_protocol.CacheStorageKeyNotFoundError: Key not found in disk cache

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 312, in _handle_cache_miss
    cached_result = cache.read_result(value_key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_data_api.py", line 636, in read_result
    raise CacheKeyNotFoundError(str(e)) from e
streamlit.runtime.caching.cache_errors.CacheKeyNotFoundError: Key not found in disk cache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/app.py", line 64, in <module>
    user_question.method = method_selector(user_question.question)  # Collect data for the user question
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 212, in wrapper
    return cached_func(*args, **kwargs)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 243, in __call__
    return self._get_or_create_cached_value(args, kwargs)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 267, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 321, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "/home/max/PycharmProjects/askbc-backend/helpers/UserQuestion.py", line 108, in method_selector
    return response["choices"][0]["message"]["function_call"]['name']
KeyError: 'function_call'
2023-11-06 18:09:51,147 - ERROR - Error occurred: 'function_call'
2023-11-06 18:09:52,507 - INFO - File uploaded to gs://ask-bc-analytics/errors/2023-11-06_18-09-51-885.json
2023-11-06 18:15:53,171 - INFO - User query: What is the weather forecast for 60091?
2023-11-06 18:15:54,741 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'What is the weather forecast for 60091?'}], Output: {
  "id": "chatcmpl-8I4z3NjulrRaGq3tsQnta75eJbVgC",
  "object": "chat.completion",
  "created": 1699319753,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": null,
        "function_call": {
          "name": "weather_forecast",
          "arguments": "{\n  \"location\": \"60091\"\n}"
        }
      },
      "finish_reason": "function_call"
    }
  ],
  "usage": {
    "prompt_tokens": 171,
    "completion_tokens": 17,
    "total_tokens": 188
  }
}
2023-11-06 18:15:54,743 - INFO - Method selected: weather_forecast
2023-11-06 18:15:57,361 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Cook", "state": "IL", "elevation": 620, "latitude": 42.0751, "longitude": -87.7228}
2023-11-06 18:15:57,369 - INFO - Getting weather_forecast for Latitude: 42.0751, Longitude: -87.7228
2023-11-06 18:15:59,205 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-06_18-15-58-558.json
2023-11-06 18:15:59,208 - INFO - Generating response - System Context: You are a helpful assistant. Summarize the context below in relation to the user question. <context> ["Forecast: [{'number': 1, 'name': 'Tonight', 'startTime': '2023-11-06T18:00:00-06:00', 'endTime': '2023-11-07T06:00:00-06:00', 'isDaytime': False, 'temperature': 43, 'temperatureUnit': 'F', 'temperatureTrend': 'rising', 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 8.88888888888889}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 82}, 'windSpeed': '10 mph', 'windDirection': 'WNW', 'icon': 'https://api.weather.gov/icons/land/night/sct?size=medium', 'shortForecast': 'Partly Cloudy', 'detailedForecast': 'Partly cloudy. Low around 43, with temperatures rising to around 45 overnight. West northwest wind around 10 mph, with gusts as high as 25 mph.'}, {'number': 2, 'name': 'Tuesday', 'startTime': '2023-11-07T06:00:00-06:00', 'endTime': '2023-11-07T18:00:00-06:00', 'isDaytime': True, 'temperature': 52, 'temperatureUnit': 'F', 'temperatureTrend': 'falling', 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 6.111111111111111}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 86}, 'windSpeed': '5 to 10 mph', 'windDirection': 'NNE', 'icon': 'https://api.weather.gov/icons/land/day/bkn?size=medium', 'shortForecast': 'Partly Sunny', 'detailedForecast': 'Partly sunny. High near 52, with temperatures falling to around 48 in the afternoon. North northeast wind 5 to 10 mph.'}, {'number': 3, 'name': 'Tuesday Night', 'startTime': '2023-11-07T18:00:00-06:00', 'endTime': '2023-11-08T06:00:00-06:00', 'isDaytime': False, 'temperature': 45, 'temperatureUnit': 'F', 'temperatureTrend': 'rising', 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 30}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 6.666666666666667}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 89}, 'windSpeed': '10 to 15 mph', 'windDirection': 'E', 'icon': 'https://api.weather.gov/icons/land/night/bkn/rain,30?size=medium', 'shortForecast': 'Mostly Cloudy then Chance Rain', 'detailedForecast': 'A chance of rain after midnight. Mostly cloudy. Low around 45, with temperatures rising to around 48 overnight. East wind 10 to 15 mph. Chance of precipitation is 30%. New rainfall amounts less than a tenth of an inch possible.'}, {'number': 4, 'name': 'Wednesday', 'startTime': '2023-11-08T06:00:00-06:00', 'endTime': '2023-11-08T18:00:00-06:00', 'isDaytime': True, 'temperature': 58, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 50}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 11.666666666666666}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 93}, 'windSpeed': '5 to 10 mph', 'windDirection': 'E', 'icon': 'https://api.weather.gov/icons/land/day/rain,40/rain,50?size=medium', 'shortForecast': 'Chance Rain', 'detailedForecast': 'A chance of rain. Cloudy, with a high near 58. East wind 5 to 10 mph, with gusts as high as 20 mph. Chance of precipitation is 50%.'}, {'number': 5, 'name': 'Wednesday Night', 'startTime': '2023-11-08T18:00:00-06:00', 'endTime': '2023-11-09T06:00:00-06:00', 'isDaytime': False, 'temperature': 44, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': 40}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 11.666666666666666}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 96}, 'windSpeed': '5 to 15 mph', 'windDirection': 'N', 'icon': 'https://api.weather.gov/icons/land/night/rain,40/bkn?size=medium', 'shortForecast': 'Chance Rain then Mostly Cloudy', 'detailedForecast': 'A chance of rain before midnight. Mostly cloudy, with a low around 44. North wind 5 to 15 mph. Chance of precipitation is 40%.'}, {'number': 6, 'name': 'Thursday', 'startTime': '2023-11-09T06:00:00-06:00', 'endTime': '2023-11-09T18:00:00-06:00', 'isDaytime': True, 'temperature': 51, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': 5.555555555555555}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 86}, 'windSpeed': '15 mph', 'windDirection': 'WNW', 'icon': 'https://api.weather.gov/icons/land/day/sct?size=medium', 'shortForecast': 'Mostly Sunny', 'detailedForecast': 'Mostly sunny, with a high near 51.'}]"] <context> 
2023-11-06 18:17:40,333 - INFO - File uploaded to gs://ask-bc-analytics/feedback/2023-11-06_18-17-39-773.json
2023-11-06 20:02:05,339 - INFO - HTTP Request: POST https://api.openai.com/v1/threads "HTTP/1.1 200 OK"
2023-11-06 20:06:25,410 - INFO - HTTP Request: POST https://api.openai.com/v1/assistants "HTTP/1.1 400 Bad Request"
2023-11-06 20:06:54,270 - INFO - HTTP Request: POST https://api.openai.com/v1/assistants "HTTP/1.1 200 OK"
2023-11-06 20:07:00,709 - INFO - HTTP Request: POST https://api.openai.com/v1/threads "HTTP/1.1 200 OK"
2023-11-06 20:13:26,336 - INFO - HTTP Request: POST https://api.openai.com/v1/threads "HTTP/1.1 200 OK"
2023-11-06 20:15:33,805 - INFO - HTTP Request: POST https://api.openai.com/v1/threads/thread_Mvc37jmeGrURlAxWfDRKJ6WQ/runs "HTTP/1.1 200 OK"
2023-11-06 20:18:21,637 - INFO - HTTP Request: GET https://api.openai.com/v1/threads/thread_Mvc37jmeGrURlAxWfDRKJ6WQ/runs/run_4GWUcV9FJiXQqfotBEdgVM8E "HTTP/1.1 200 OK"
2023-11-06 20:22:29,344 - INFO - HTTP Request: GET https://api.openai.com/v1/threads/thread_Mvc37jmeGrURlAxWfDRKJ6WQ "HTTP/1.1 200 OK"
2023-11-06 20:27:01,523 - INFO - HTTP Request: POST https://api.openai.com/v1/threads/thread_Mvc37jmeGrURlAxWfDRKJ6WQ/messages "HTTP/1.1 200 OK"
2023-11-06 20:27:50,000 - INFO - HTTP Request: POST https://api.openai.com/v1/threads/thread_Mvc37jmeGrURlAxWfDRKJ6WQ/runs "HTTP/1.1 200 OK"
2023-11-06 20:27:59,557 - INFO - HTTP Request: GET https://api.openai.com/v1/threads/thread_Mvc37jmeGrURlAxWfDRKJ6WQ/runs/run_9kMlcDH6BbBhUgTSH1lDbjZO "HTTP/1.1 200 OK"
2023-11-06 20:29:17,766 - INFO - HTTP Request: GET https://api.openai.com/v1/threads/thread_Mvc37jmeGrURlAxWfDRKJ6WQ/messages/msg_TnFyXLdhnekWm3xDYXB3MvMz "HTTP/1.1 200 OK"
2023-11-09 20:59:00,361 - INFO - User query: How much snow is at Vail Mountain?
2023-11-09 20:59:00,378 - ERROR - An error occurred:
Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 87, in get
    entry_bytes = self._read_from_mem_cache(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 137, in _read_from_mem_cache
    raise CacheStorageKeyNotFoundError("Key not found in mem cache")
streamlit.runtime.caching.storage.cache_storage_protocol.CacheStorageKeyNotFoundError: Key not found in mem cache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/local_disk_cache_storage.py", line 145, in get
    with streamlit_read(path, binary=True) as input:
  File "/usr/lib/python3.10/contextlib.py", line 135, in __enter__
    return next(self.gen)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/file_util.py", line 77, in streamlit_read
    if os.stat(filename).st_size == 0:
FileNotFoundError: [Errno 2] No such file or directory: '/home/max/.streamlit/cache/d4a49b96bb57319b6d01e9e86d8e04a0-9a499fa1ea61142e4d6eca3c2feca085.memo'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_data_api.py", line 634, in read_result
    pickled_entry = self.storage.get(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 89, in get
    entry_bytes = self._persist_storage.get(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/local_disk_cache_storage.py", line 150, in get
    raise CacheStorageKeyNotFoundError("Key not found in disk cache")
streamlit.runtime.caching.storage.cache_storage_protocol.CacheStorageKeyNotFoundError: Key not found in disk cache

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 264, in _get_or_create_cached_value
    cached_result = cache.read_result(value_key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_data_api.py", line 636, in read_result
    raise CacheKeyNotFoundError(str(e)) from e
streamlit.runtime.caching.cache_errors.CacheKeyNotFoundError: Key not found in disk cache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 87, in get
    entry_bytes = self._read_from_mem_cache(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 137, in _read_from_mem_cache
    raise CacheStorageKeyNotFoundError("Key not found in mem cache")
streamlit.runtime.caching.storage.cache_storage_protocol.CacheStorageKeyNotFoundError: Key not found in mem cache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/local_disk_cache_storage.py", line 145, in get
    with streamlit_read(path, binary=True) as input:
  File "/usr/lib/python3.10/contextlib.py", line 135, in __enter__
    return next(self.gen)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/file_util.py", line 77, in streamlit_read
    if os.stat(filename).st_size == 0:
FileNotFoundError: [Errno 2] No such file or directory: '/home/max/.streamlit/cache/d4a49b96bb57319b6d01e9e86d8e04a0-9a499fa1ea61142e4d6eca3c2feca085.memo'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_data_api.py", line 634, in read_result
    pickled_entry = self.storage.get(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 89, in get
    entry_bytes = self._persist_storage.get(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/local_disk_cache_storage.py", line 150, in get
    raise CacheStorageKeyNotFoundError("Key not found in disk cache")
streamlit.runtime.caching.storage.cache_storage_protocol.CacheStorageKeyNotFoundError: Key not found in disk cache

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 312, in _handle_cache_miss
    cached_result = cache.read_result(value_key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_data_api.py", line 636, in read_result
    raise CacheKeyNotFoundError(str(e)) from e
streamlit.runtime.caching.cache_errors.CacheKeyNotFoundError: Key not found in disk cache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/app.py", line 64, in <module>
    user_question.method = method_selector(user_question.question)  # Collect data for the user question
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 212, in wrapper
    return cached_func(*args, **kwargs)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 243, in __call__
    return self._get_or_create_cached_value(args, kwargs)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 267, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 321, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "/home/max/PycharmProjects/askbc-backend/helpers/UserQuestion.py", line 95, in method_selector
    response = openai.ChatCompletion.create(
AttributeError: module 'openai' has no attribute 'ChatCompletion'
2023-11-09 20:59:00,400 - ERROR - Error occurred: module 'openai' has no attribute 'ChatCompletion'
2023-11-09 20:59:01,763 - INFO - File uploaded to gs://ask-bc-analytics/errors/2023-11-09_20-59-01-066.json
2023-11-09 21:04:29,151 - INFO - User query: How much snow is at Vail Mountain?
2023-11-09 21:04:32,419 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-09 21:04:32,432 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'How much snow is at Vail Mountain?'}], Output: ChatCompletion(id='chatcmpl-8JD2siwQZ09cclg2yOKhaE0Kd4mPv', choices=[Choice(finish_reason='function_call', index=0, message=ChatCompletionMessage(content=None, role='assistant', function_call=FunctionCall(arguments='{\n  "user_question": "How much snow is at Vail Mountain?"\n}', name='snow_depth_data'), tool_calls=None))], created=1699589070, model='gpt-4-0613', object='chat.completion', system_fingerprint=None, usage=CompletionUsage(completion_tokens=25, prompt_tokens=173, total_tokens=198))
2023-11-09 21:04:32,434 - ERROR - An error occurred:
Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 87, in get
    entry_bytes = self._read_from_mem_cache(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 137, in _read_from_mem_cache
    raise CacheStorageKeyNotFoundError("Key not found in mem cache")
streamlit.runtime.caching.storage.cache_storage_protocol.CacheStorageKeyNotFoundError: Key not found in mem cache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/local_disk_cache_storage.py", line 145, in get
    with streamlit_read(path, binary=True) as input:
  File "/usr/lib/python3.10/contextlib.py", line 135, in __enter__
    return next(self.gen)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/file_util.py", line 77, in streamlit_read
    if os.stat(filename).st_size == 0:
FileNotFoundError: [Errno 2] No such file or directory: '/home/max/.streamlit/cache/07f81ca69b3536de23fe6c2f004fc3d5-9a499fa1ea61142e4d6eca3c2feca085.memo'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_data_api.py", line 634, in read_result
    pickled_entry = self.storage.get(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 89, in get
    entry_bytes = self._persist_storage.get(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/local_disk_cache_storage.py", line 150, in get
    raise CacheStorageKeyNotFoundError("Key not found in disk cache")
streamlit.runtime.caching.storage.cache_storage_protocol.CacheStorageKeyNotFoundError: Key not found in disk cache

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 264, in _get_or_create_cached_value
    cached_result = cache.read_result(value_key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_data_api.py", line 636, in read_result
    raise CacheKeyNotFoundError(str(e)) from e
streamlit.runtime.caching.cache_errors.CacheKeyNotFoundError: Key not found in disk cache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 87, in get
    entry_bytes = self._read_from_mem_cache(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 137, in _read_from_mem_cache
    raise CacheStorageKeyNotFoundError("Key not found in mem cache")
streamlit.runtime.caching.storage.cache_storage_protocol.CacheStorageKeyNotFoundError: Key not found in mem cache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/local_disk_cache_storage.py", line 145, in get
    with streamlit_read(path, binary=True) as input:
  File "/usr/lib/python3.10/contextlib.py", line 135, in __enter__
    return next(self.gen)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/file_util.py", line 77, in streamlit_read
    if os.stat(filename).st_size == 0:
FileNotFoundError: [Errno 2] No such file or directory: '/home/max/.streamlit/cache/07f81ca69b3536de23fe6c2f004fc3d5-9a499fa1ea61142e4d6eca3c2feca085.memo'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_data_api.py", line 634, in read_result
    pickled_entry = self.storage.get(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/in_memory_cache_storage_wrapper.py", line 89, in get
    entry_bytes = self._persist_storage.get(key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/storage/local_disk_cache_storage.py", line 150, in get
    raise CacheStorageKeyNotFoundError("Key not found in disk cache")
streamlit.runtime.caching.storage.cache_storage_protocol.CacheStorageKeyNotFoundError: Key not found in disk cache

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 312, in _handle_cache_miss
    cached_result = cache.read_result(value_key)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_data_api.py", line 636, in read_result
    raise CacheKeyNotFoundError(str(e)) from e
streamlit.runtime.caching.cache_errors.CacheKeyNotFoundError: Key not found in disk cache

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/app.py", line 64, in <module>
    user_question.method = method_selector(user_question.question)  # Collect data for the user question
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 212, in wrapper
    return cached_func(*args, **kwargs)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 243, in __call__
    return self._get_or_create_cached_value(args, kwargs)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 267, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "/home/max/PycharmProjects/askbc-backend/venv/lib/python3.10/site-packages/streamlit/runtime/caching/cache_utils.py", line 321, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "/home/max/PycharmProjects/askbc-backend/helpers/UserQuestion.py", line 108, in method_selector
    return response["choices"][0]["message"]["function_call"]['name']
TypeError: 'ChatCompletion' object is not subscriptable
2023-11-09 21:04:32,449 - ERROR - Error occurred: 'ChatCompletion' object is not subscriptable
2023-11-09 21:04:33,856 - INFO - File uploaded to gs://ask-bc-analytics/errors/2023-11-09_21-04-33-310.json
2023-11-09 21:10:41,687 - INFO - User query: How much snow is at Vail Mountain?
2023-11-09 21:10:44,647 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-09 21:10:44,655 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'How much snow is at Vail Mountain?'}], Output: ChatCompletion(id='chatcmpl-8JD8tdvHt6ifR0B5mxNrJov7171nA', choices=[Choice(finish_reason='function_call', index=0, message=ChatCompletionMessage(content=None, role='assistant', function_call=FunctionCall(arguments='{\n  "user_question": "How much snow is at Vail Mountain?"\n}', name='snow_depth_data'), tool_calls=None))], created=1699589443, model='gpt-4-0613', object='chat.completion', system_fingerprint=None, usage=CompletionUsage(completion_tokens=25, prompt_tokens=173, total_tokens=198))
2023-11-09 21:10:44,659 - INFO - Method selected: snow_depth_data
2023-11-09 21:10:47,513 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-09 21:10:47,520 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Eagle", "state": "CO", "elevation": 11250, "latitude": 39.6403, "longitude": -106.3742}
2023-11-09 21:10:56,012 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-09 21:10:56,021 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(date) AS max_date
  FROM `avalanche-analytics-project.production.snotel`
  WHERE county_name = 'Eagle' AND state_code = 'CO' AND elevation_ft > 8250
)

SELECT AVG(snow_depth_in) AS average_snow_depth
FROM `avalanche-analytics-project.production.snotel` AS s
JOIN LatestDate AS ld
ON s.date = ld.max_date
WHERE s.county_name = 'Eagle' AND s.state_code = 'CO' AND s.elevation_ft > 8250
LIMIT 1;
2023-11-09 21:11:01,337 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-09_21-11-00-622.json
2023-11-09 21:11:01,342 - INFO - Generating response - System Context: You are a helpful assistant. Summarize the context below in relation to the user question. <context> [[{'average_snow_depth': 3.6666666666666665}]] <context> 
2023-11-09 21:11:02,035 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-09 21:13:58,087 - INFO - User query: How much snow is at Vail Mountain?
2023-11-09 21:13:58,097 - INFO - Method selected: snow_depth_data
2023-11-09 21:14:09,621 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-09 21:14:09,625 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(date) AS max_date
  FROM `avalanche-analytics-project.production.snotel`
  WHERE county_name = 'Eagle' AND state_code = 'CO' AND elevation_ft > 8250
)

SELECT AVG(snow_depth_in) AS average_snow_depth_inches
FROM `avalanche-analytics-project.production.snotel` AS s
JOIN LatestDate AS ld
ON s.date = ld.max_date
WHERE s.county_name = 'Eagle' AND s.state_code = 'CO' AND s.elevation_ft > 8250
LIMIT 1;
2023-11-09 21:14:14,228 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-09_21-14-13-554.json
2023-11-09 21:14:14,233 - INFO - Generating response - System Context: You are a helpful assistant. Summarize the context below in relation to the user question. <context> [[{'average_snow_depth_inches': 3.6666666666666665}]] <context> 
2023-11-09 21:14:15,062 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-09 21:14:41,154 - INFO - File uploaded to gs://ask-bc-analytics/feedback/2023-11-09_21-14-40-495.json
2023-11-09 21:14:55,102 - INFO - User query: What is the weather forecast for Vail Mountain?
2023-11-09 21:14:57,644 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-09 21:14:57,653 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'What is the weather forecast for Vail Mountain?'}], Output: ChatCompletion(id='chatcmpl-8JDCxVRjYyePCVxbbhV2UirjHifJw', choices=[Choice(finish_reason='function_call', index=0, message=ChatCompletionMessage(content=None, role='assistant', function_call=FunctionCall(arguments='{\n  "location": "Vail Mountain"\n}', name='weather_forecast'), tool_calls=None))], created=1699589695, model='gpt-4-0613', object='chat.completion', system_fingerprint=None, usage=CompletionUsage(completion_tokens=18, prompt_tokens=174, total_tokens=192))
2023-11-09 21:14:57,656 - INFO - Method selected: weather_forecast
2023-11-09 21:15:00,759 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-09 21:15:00,766 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Eagle", "state": "CO", "elevation": 11250, "latitude": 39.6403, "longitude": -106.3748}
2023-11-09 21:15:00,773 - INFO - Getting weather_forecast for Latitude: 39.6403, Longitude: -106.3748
2023-11-09 21:15:03,172 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-09_21-15-02-466.json
2023-11-09 21:15:03,178 - INFO - Generating response - System Context: You are a helpful assistant. Summarize the context below in relation to the user question. <context> ["Forecast: [{'number': 1, 'name': 'Tonight', 'startTime': '2023-11-09T21:00:00-07:00', 'endTime': '2023-11-10T06:00:00-07:00', 'isDaytime': False, 'temperature': 10, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -13.333333333333334}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 66}, 'windSpeed': '5 mph', 'windDirection': 'E', 'icon': 'https://api.weather.gov/icons/land/night/cold?size=medium', 'shortForecast': 'Mostly Clear', 'detailedForecast': 'Mostly clear, with a low around 10. East wind around 5 mph.'}, {'number': 2, 'name': 'Friday', 'startTime': '2023-11-10T06:00:00-07:00', 'endTime': '2023-11-10T18:00:00-07:00', 'isDaytime': True, 'temperature': 42, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -13.333333333333334}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 63}, 'windSpeed': '5 to 10 mph', 'windDirection': 'W', 'icon': 'https://api.weather.gov/icons/land/day/few?size=medium', 'shortForecast': 'Sunny', 'detailedForecast': 'Sunny, with a high near 42. West wind 5 to 10 mph.'}, {'number': 3, 'name': 'Friday Night', 'startTime': '2023-11-10T18:00:00-07:00', 'endTime': '2023-11-11T06:00:00-07:00', 'isDaytime': False, 'temperature': 16, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -11.11111111111111}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 75}, 'windSpeed': '0 to 5 mph', 'windDirection': 'E', 'icon': 'https://api.weather.gov/icons/land/night/sct?size=medium', 'shortForecast': 'Partly Cloudy', 'detailedForecast': 'Partly cloudy, with a low around 16. East wind 0 to 5 mph.'}, {'number': 4, 'name': 'Veterans Day', 'startTime': '2023-11-11T06:00:00-07:00', 'endTime': '2023-11-11T18:00:00-07:00', 'isDaytime': True, 'temperature': 42, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -10.555555555555555}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 74}, 'windSpeed': '0 to 10 mph', 'windDirection': 'WSW', 'icon': 'https://api.weather.gov/icons/land/day/few?size=medium', 'shortForecast': 'Sunny', 'detailedForecast': 'Sunny, with a high near 42. West southwest wind 0 to 10 mph.'}, {'number': 5, 'name': 'Saturday Night', 'startTime': '2023-11-11T18:00:00-07:00', 'endTime': '2023-11-12T06:00:00-07:00', 'isDaytime': False, 'temperature': 18, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -12.777777777777779}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 56}, 'windSpeed': '5 mph', 'windDirection': 'SSW', 'icon': 'https://api.weather.gov/icons/land/night/skc?size=medium', 'shortForecast': 'Clear', 'detailedForecast': 'Clear, with a low around 18. South southwest wind around 5 mph.'}, {'number': 6, 'name': 'Sunday', 'startTime': '2023-11-12T06:00:00-07:00', 'endTime': '2023-11-12T18:00:00-07:00', 'isDaytime': True, 'temperature': 52, 'temperatureUnit': 'F', 'temperatureTrend': None, 'probabilityOfPrecipitation': {'unitCode': 'wmoUnit:percent', 'value': None}, 'dewpoint': {'unitCode': 'wmoUnit:degC', 'value': -10.555555555555555}, 'relativeHumidity': {'unitCode': 'wmoUnit:percent', 'value': 55}, 'windSpeed': '5 mph', 'windDirection': 'SSW', 'icon': 'https://api.weather.gov/icons/land/day/few?size=medium', 'shortForecast': 'Sunny', 'detailedForecast': 'Sunny, with a high near 52.'}]"] <context> 
2023-11-09 21:15:05,426 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-09 21:15:29,992 - INFO - File uploaded to gs://ask-bc-analytics/feedback/2023-11-09_21-15-29-460.json
2023-11-09 21:28:31,167 - INFO - User query: How much new snow fell at Vail Mountain station in the past 2 days?
2023-11-09 21:28:33,737 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-09 21:28:33,746 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'How much new snow fell at Vail Mountain station in the past 2 days?'}], Output: ChatCompletion(id='chatcmpl-8JDQ7JwnyXU6UB4I0IyOrDFWjD26o', choices=[Choice(finish_reason='function_call', index=0, message=ChatCompletionMessage(content=None, role='assistant', function_call=FunctionCall(arguments='{\n  "user_question": "How much new snow fell at Vail Mountain station in the past 2 days?"\n}', name='snow_depth_data'), tool_calls=None))], created=1699590511, model='gpt-4-0613', object='chat.completion', system_fingerprint=None, usage=CompletionUsage(completion_tokens=33, prompt_tokens=181, total_tokens=214))
2023-11-09 21:28:33,750 - INFO - Method selected: snow_depth_data
2023-11-09 21:28:37,166 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-09 21:28:37,169 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Eagle", "state": "CO", "elevation": 8150, "latitude": 39.6403, "longitude": -106.3748}
2023-11-09 21:28:43,004 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-09 21:28:43,013 - INFO - Snow depth SQL query: SELECT SUM(new_snow) AS total_new_snow_inches
FROM `avalanche-analytics-project.production.snotel`
WHERE station_name = 'Vail Mountain' AND state_code = 'CO' AND elevation_ft > 5150
AND date >= DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY)
LIMIT 1;
2023-11-09 21:28:47,174 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-09_21-28-46-538.json
2023-11-09 21:28:47,180 - INFO - Generating response - System Context: You are a helpful assistant. Summarize the context below in relation to the user question. <context> [[{'total_new_snow_inches': 1.0}]] <context> 
2023-11-09 21:28:48,021 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-09 21:28:56,316 - INFO - File uploaded to gs://ask-bc-analytics/feedback/2023-11-09_21-28-55-720.json
2023-11-09 21:30:48,967 - INFO - User query: What is the snow depth a Mccoy Park station?
2023-11-09 21:30:51,722 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-09 21:30:51,733 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'What is the snow depth a Mccoy Park station?'}], Output: ChatCompletion(id='chatcmpl-8JDSLPp1nwmP2Ltk9W3H6g8ubDh7d', choices=[Choice(finish_reason='function_call', index=0, message=ChatCompletionMessage(content=None, role='assistant', function_call=FunctionCall(arguments='{\n"user_question": "What is the snow depth at Mccoy Park station?"\n}', name='snow_depth_data'), tool_calls=None))], created=1699590649, model='gpt-4-0613', object='chat.completion', system_fingerprint=None, usage=CompletionUsage(completion_tokens=26, prompt_tokens=176, total_tokens=202))
2023-11-09 21:30:51,737 - INFO - Method selected: snow_depth_data
2023-11-09 21:30:55,201 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-09 21:30:55,207 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Eagle", "state": "CO", "elevation": 9700, "latitude": 39.6042, "longitude": -106.5168}
2023-11-09 21:31:06,568 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-09 21:31:06,578 - INFO - Snow depth SQL query: WITH LatestDate AS (
  SELECT MAX(date) AS max_date
  FROM `avalanche-analytics-project.production.snotel`
  WHERE county_name = 'Eagle' AND state_code = 'CO' AND elevation_ft > 6700
)

SELECT AVG(snow_depth_in) AS average_snow_depth_inches
FROM `avalanche-analytics-project.production.snotel` AS s
JOIN LatestDate AS ld
ON s.date = ld.max_date
WHERE s.county_name = 'Eagle' AND s.state_code = 'CO' AND s.elevation_ft > 6700
LIMIT 1;
2023-11-09 21:31:10,585 - INFO - File uploaded to gs://ask-bc-analytics/sql-queries/2023-11-09_21-31-10-020.json
2023-11-09 21:31:10,589 - INFO - Generating response - System Context: You are a helpful assistant. Summarize the context below in relation to the user question. <context> [[{'average_snow_depth_inches': 3.6666666666666665}]] <context> 
2023-11-09 21:31:11,175 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 09:27:51,611 - INFO - File uploaded to gs://ask-bc-analytics/feature_requests/2023-11-14_09-27-51-065.json
2023-11-14 11:37:44,654 - INFO - File uploaded to gs://ask-bc-analytics/feature_requests/2023-11-14_11-37-44-036.json
2023-11-14 18:06:54,934 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:09:46,019 - INFO - User query: What are the current CAIC observations for Summit County?
2023-11-14 18:09:47,763 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:09:47,772 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'What are the current CAIC observations for Summit County?'}], Output: ChatCompletion(id='chatcmpl-8KyhWJmvemos6vItYwh0Md49UuRFp', choices=[Choice(finish_reason='function_call', index=0, message=ChatCompletionMessage(content=None, role='assistant', function_call=FunctionCall(arguments='{\n  "zone": "Vail & Summit County"\n}', name='co_field_obv'), tool_calls=None))], created=1700010586, model='gpt-4-0613', object='chat.completion', system_fingerprint=None, usage=CompletionUsage(completion_tokens=21, prompt_tokens=215, total_tokens=236))
2023-11-14 18:09:47,775 - INFO - Method selected: co_field_obv
2023-11-14 18:09:49,808 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:09:49,814 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Summit", "state": "CO", "elevation": 9185, "latitude": 39.5501, "longitude": -106.1781}
2023-11-14 18:09:57,357 - ERROR - An error occurred:
Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/app.py", line 103, in <module>
    upload_blob_from_memory(bucket_name='ask-bc-analytics', contents=json.dumps(st.session_state.sql),
  File "/home/max/PycharmProjects/askbc-backend/helpers/UserQuestion.py", line 51, in upload_blob_from_memory
    current_datetime = datetime.datetime.now()
AttributeError: type object 'datetime.datetime' has no attribute 'datetime'
2023-11-14 18:09:57,360 - ERROR - Error occurred: type object 'datetime.datetime' has no attribute 'datetime'
2023-11-14 18:12:56,692 - INFO - User query: What are the current CAIC observations for Summit County?
2023-11-14 18:12:58,112 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:12:58,122 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'What are the current CAIC observations for Summit County?'}], Output: ChatCompletion(id='chatcmpl-8Kyka33A1vBl01NYUdYZ8arQHHStV', choices=[Choice(finish_reason='function_call', index=0, message=ChatCompletionMessage(content=None, role='assistant', function_call=FunctionCall(arguments='{\n  "zone": "Summit County"\n}', name='co_field_obv'), tool_calls=None))], created=1700010776, model='gpt-4-0613', object='chat.completion', system_fingerprint=None, usage=CompletionUsage(completion_tokens=19, prompt_tokens=215, total_tokens=234))
2023-11-14 18:12:58,126 - INFO - Method selected: co_field_obv
2023-11-14 18:13:00,266 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:13:00,273 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Summit", "state": "CO", "elevation": 9185, "latitude": 39.5501, "longitude": -106.1781}
2023-11-14 18:13:06,568 - INFO - Generating response - System Context: You are a helpful assistant. Summarize the context below in relation to the user question. <context> ['No observations found for this zone in the last week.'] <context> 
2023-11-14 18:13:07,843 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:15:50,276 - INFO - User query: What are the current CAIC observations for Summit County?
2023-11-14 18:15:51,672 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:15:51,680 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'What are the current CAIC observations for Summit County?'}], Output: ChatCompletion(id='chatcmpl-8KynOn6T3RdGgkiu7L5BNPNowZRCw', choices=[Choice(finish_reason='function_call', index=0, message=ChatCompletionMessage(content=None, role='assistant', function_call=FunctionCall(arguments='{\n  "zone": "Vail & Summit County"\n}', name='co_field_obv'), tool_calls=None))], created=1700010950, model='gpt-4-0613', object='chat.completion', system_fingerprint=None, usage=CompletionUsage(completion_tokens=21, prompt_tokens=215, total_tokens=236))
2023-11-14 18:15:51,684 - INFO - Method selected: co_field_obv
2023-11-14 18:15:53,559 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:15:53,568 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Summit", "state": "CO", "elevation": 9185, "latitude": 39.5501, "longitude": -106.1781}
2023-11-14 18:15:59,569 - INFO - Generating response - System Context: You are a helpful assistant. Summarize the context below in relation to the user question. <context> ['No observations found for this zone in the last week.'] <context> 
2023-11-14 18:16:01,193 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:17:21,083 - INFO - User query: What are the current CAIC observations for Summit County?
2023-11-14 18:17:22,498 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:17:22,508 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'What are the current CAIC observations for Summit County?'}], Output: ChatCompletion(id='chatcmpl-8KyorJ31lCXsHYnmIeDmWkMqjinZs', choices=[Choice(finish_reason='function_call', index=0, message=ChatCompletionMessage(content=None, role='assistant', function_call=FunctionCall(arguments='{\n  "zone": "Vail & Summit County"\n}', name='co_field_obv'), tool_calls=None))], created=1700011041, model='gpt-4-0613', object='chat.completion', system_fingerprint=None, usage=CompletionUsage(completion_tokens=21, prompt_tokens=229, total_tokens=250))
2023-11-14 18:17:22,512 - INFO - Method selected: co_field_obv
2023-11-14 18:17:24,956 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:17:24,963 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Summit", "state": "CO", "elevation": 9185, "latitude": 39.5501, "longitude": -106.1781}
2023-11-14 18:17:32,243 - INFO - Generating response - System Context: You are a helpful assistant. Summarize the context below in relation to the user question. <context> ['No observations found for this zone in the last week.'] <context> 
2023-11-14 18:17:33,475 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:18:18,361 - INFO - User query: What are the current CAIC observations for the Aspen Zone?
2023-11-14 18:18:19,752 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:18:19,762 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'What are the current CAIC observations for the Aspen Zone?'}], Output: ChatCompletion(id='chatcmpl-8KypmXR5HvhnUfbqwwXi86twbMkEH', choices=[Choice(finish_reason='function_call', index=0, message=ChatCompletionMessage(content=None, role='assistant', function_call=FunctionCall(arguments='{\n  "zone": "Aspen"\n}', name='co_field_obv'), tool_calls=None))], created=1700011098, model='gpt-4-0613', object='chat.completion', system_fingerprint=None, usage=CompletionUsage(completion_tokens=18, prompt_tokens=230, total_tokens=248))
2023-11-14 18:18:19,766 - INFO - Method selected: co_field_obv
2023-11-14 18:18:22,399 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:18:22,408 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Pitkin", "state": "CO", "elevation": 8000, "latitude": 39.1911, "longitude": -106.8175}
2023-11-14 18:18:29,593 - INFO - Generating response - System Context: You are a helpful assistant. Summarize the context below in relation to the user question. <context> ['No observations found for this zone in the last week.'] <context> 
2023-11-14 18:18:32,025 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:21:31,299 - INFO - User query: What are the current CAIC observations for the Aspen zone?
2023-11-14 18:21:32,758 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:21:32,765 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'What are the current CAIC observations for the Aspen zone?'}], Output: ChatCompletion(id='chatcmpl-8Kystr7zfzCpyO1yAno5tyOJAZ3JF', choices=[Choice(finish_reason='function_call', index=0, message=ChatCompletionMessage(content=None, role='assistant', function_call=FunctionCall(arguments='{\n  "zone": "Aspen"\n}', name='co_field_obv'), tool_calls=None))], created=1700011291, model='gpt-4-0613', object='chat.completion', system_fingerprint=None, usage=CompletionUsage(completion_tokens=18, prompt_tokens=230, total_tokens=248))
2023-11-14 18:21:32,769 - INFO - Method selected: co_field_obv
2023-11-14 18:21:34,887 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:21:34,894 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Pitkin", "state": "CO", "elevation": 7908, "latitude": 39.1911, "longitude": -106.8175}
2023-11-14 18:21:34,900 - ERROR - An error occurred:
Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/app.py", line 104, in <module>
    print(args['zone'])
TypeError: string indices must be integers
2023-11-14 18:21:34,905 - ERROR - Error occurred: string indices must be integers
2023-11-14 18:23:37,745 - INFO - User query: What are the current CAIC observations for the Aspen zone?
2023-11-14 18:23:37,761 - INFO - Method selected: co_field_obv
2023-11-14 18:23:39,939 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:23:39,948 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Pitkin", "state": "CO", "elevation": 7908, "latitude": 39.1911, "longitude": -106.8175}
2023-11-14 18:23:39,952 - ERROR - An error occurred:
Traceback (most recent call last):
  File "/home/max/PycharmProjects/askbc-backend/app.py", line 104, in <module>
    print(args['zone'])
TypeError: string indices must be integers
2023-11-14 18:23:39,955 - ERROR - Error occurred: string indices must be integers
2023-11-14 18:23:41,285 - INFO - File uploaded to gs://ask-bc-analytics/errors/2023-11-14_18-23-40-674.json
2023-11-14 18:24:46,256 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:27:19,888 - INFO - User query: What are the current CAIC observations for the Aspen zone?
2023-11-14 18:27:21,530 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:27:21,535 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'What are the current CAIC observations for the Aspen zone?'}], Output: ChatCompletion(id='chatcmpl-8KyyWutYK8lXqwlzbqPPCbJ2DGddp', choices=[Choice(finish_reason='function_call', index=0, message=ChatCompletionMessage(content=None, role='assistant', function_call=FunctionCall(arguments='{\n  "zone": "Aspen"\n}', name='co_field_obv'), tool_calls=None))], created=1700011640, model='gpt-4-0613', object='chat.completion', system_fingerprint=None, usage=CompletionUsage(completion_tokens=18, prompt_tokens=230, total_tokens=248))
2023-11-14 18:27:21,536 - INFO - Method selected: co_field_obv
2023-11-14 18:27:24,193 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:27:24,201 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Pitkin", "state": "CO", "elevation": 7908, "latitude": 39.1911, "longitude": -106.8175}
2023-11-14 18:27:30,000 - INFO - Generating response - System Context: You are a helpful assistant. Summarize the context below in relation to the user question. <context> [[{'observed_at': '2023-11-14T07:00:00.000Z', 'backcountry_zone': 'Aspen', 'url': 'https://api.avalanche.state.co.us/api/v2/observation_reports/ac6a11f4-8458-46f1-8b1c-2b373fcc905d.json', 'area': 'Hunter-Fryingpan Wilderness', 'route': 'Driving around the Frying Pan as far as the snow would safely allow.', 'avalanche_observations': None, 'weather_observation': None, 'snowpack_observations': [{'id': '171c009f-b2c7-4653-ae44-5ca3c2a89559', 'type': 'snowpack_observation', 'backcountry_zone_id': 'eea3da9e-28a3-4327-906e-132937649559', 'backcountry_zone': {'id': 'eea3da9e-28a3-4327-906e-132937649559', 'type': 'backcountry_zone', 'parent_id': '3ffc2e26-7641-422e-91ea-e025380c7777', 'slug': 'aspen', 'title': 'Aspen', 'category': 'backcountry', 'category_order': 4, 'is_root': False, 'is_leaf': True, 'tree_level': 2, 'parent_url': 'https://api.avalanche.state.co.us/api/v2/zones/central-mountains.json', 'created_at': '2019-10-31T21:41:58.551Z', 'updated_at': '2020-06-09T23:06:09.514Z', 'url': 'https://api.avalanche.state.co.us/api/v2/zones/aspen.json', 'geojson_url': 'https://api.avalanche.state.co.us/api/v2/zones/map/aspen.geojson'}, 'highway_zone_id': None, 'observed_at': '2023-11-14T07:00:00.000Z', 'created_at': '2023-11-15T00:01:04Z', 'updated_at': '2023-11-15T00:01:04Z', 'latitude': 39.2593433, 'longitude': -106.5424669, 'comments': None, 'url': 'https://api.avalanche.state.co.us/api/v2/snowpack_observations/171c009f-b2c7-4653-ae44-5ca3c2a89559.json', 'cracking': 'None', 'collapsing': 'None', 'weak_layers': None, 'rose': '000000000000000000000000', 'snowpack_detail': {'id': '8bda2024-071c-45ae-a0f4-947278b47b91', 'type': 'snowpack_detail', 'description': 'The few shady slopes I got to were 10-20cm deep with well-developed facets making up the top 2-3cm of the snowpack on top of a P-hard (on the hand hardness scale) melt-freeze crust with another layer of well-developed, striated, 3mm facets down to the ground. Looking at the west side of the Continental divide the snowpack is very thin with rocky and terrain features breaking the snow surface everywhere. The only slopes with continuous snow coverage were the tops of leeward-facing slopes and cross-loaded gullies.', 'classic_id': None}}], 'weather_detail': {'id': '9130ce73-dc33-4afb-9882-66239b0b362e', 'type': 'weather_detail', 'description': 'Calm bluebird day with a cold morning warming up to above-freezing temperatures after about 9:00 AM around 9500 feet.', 'classic_id': None}, 'snowpack_detail': {'id': '8bda2024-071c-45ae-a0f4-947278b47b91', 'type': 'snowpack_detail', 'description': 'The few shady slopes I got to were 10-20cm deep with well-developed facets making up the top 2-3cm of the snowpack on top of a P-hard (on the hand hardness scale) melt-freeze crust with another layer of well-developed, striated, 3mm facets down to the ground. Looking at the west side of the Continental divide the snowpack is very thin with rocky and terrain features breaking the snow surface everywhere. The only slopes with continuous snow coverage were the tops of leeward-facing slopes and cross-loaded gullies.', 'classic_id': None}}, {'observed_at': '2023-11-13T07:00:00.000Z', 'backcountry_zone': 'Aspen', 'url': 'https://api.avalanche.state.co.us/api/v2/observation_reports/b085b37c-f763-44e6-b666-e684487c7393.json', 'area': None, 'route': 'Washington Gulch to Paradise Divide', 'avalanche_observations': None, 'weather_observation': None, 'snowpack_observations': [{'id': 'ff0b9f09-3b92-48d9-9396-113c0e5ac752', 'type': 'snowpack_observation', 'backcountry_zone_id': 'eea3da9e-28a3-4327-906e-132937649559', 'backcountry_zone': {'id': 'eea3da9e-28a3-4327-906e-132937649559', 'type': 'backcountry_zone', 'parent_id': '3ffc2e26-7641-422e-91ea-e025380c7777', 'slug': 'aspen', 'title': 'Aspen', 'category': 'backcountry', 'category_order': 4, 'is_root': False, 'is_leaf': True, 'tree_level': 2, 'parent_url': 'https://api.avalanche.state.co.us/api/v2/zones/central-mountains.json', 'created_at': '2019-10-31T21:41:58.551Z', 'updated_at': '2020-06-09T23:06:09.514Z', 'url': 'https://api.avalanche.state.co.us/api/v2/zones/aspen.json', 'geojson_url': 'https://api.avalanche.state.co.us/api/v2/zones/map/aspen.geojson'}, 'highway_zone_id': None, 'observed_at': '2023-11-13T07:00:00.000Z', 'created_at': '2023-11-14T00:21:03Z', 'updated_at': '2023-11-14T00:21:03Z', 'latitude': 38.9881644, 'longitude': -107.0622847, 'comments': None, 'url': 'https://api.avalanche.state.co.us/api/v2/snowpack_observations/ff0b9f09-3b92-48d9-9396-113c0e5ac752.json', 'cracking': 'Minor', 'collapsing': 'None', 'weak_layers': None, 'rose': '000000000000000000000000', 'snowpack_detail': {'id': '82826417-2be1-485b-9f33-92efeef48112', 'type': 'snowpack_detail', 'description': "Northerly-facing slopes near treeline, or wind-sheltered spots above treeline will not hold much of a slab if snowfall ramps up next weekend.\r\nSoutheast and west-facing slopes held wet snow, that will freeze into an icy mass. Snow-covered slopes on these aspects might work as a future bed surface, but they lack prominent weak layers up to around 12,000' (no hands-on observations from higher elevations) or maybe higher.\r\nSouth and southwest slopes are mostly melted out and post little concern in the next week to ten days.", 'classic_id': None}}], 'weather_detail': {'id': '85169ce8-271f-4c07-974f-93ff21e37726', 'type': 'weather_detail', 'description': 'Warm with a gentle breeze.', 'classic_id': None}, 'snowpack_detail': {'id': '82826417-2be1-485b-9f33-92efeef48112', 'type': 'snowpack_detail', 'description': "Northerly-facing slopes near treeline, or wind-sheltered spots above treeline will not hold much of a slab if snowfall ramps up next weekend.\r\nSoutheast and west-facing slopes held wet snow, that will freeze into an icy mass. Snow-covered slopes on these aspects might work as a future bed surface, but they lack prominent weak layers up to around 12,000' (no hands-on observations from higher elevations) or maybe higher.\r\nSouth and southwest slopes are mostly melted out and post little concern in the next week to ten days.", 'classic_id': None}}]] <context> 
2023-11-14 18:27:33,242 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:28:55,413 - INFO - User query: What are the current CAIC observations for the Aspen zone?
2023-11-14 18:28:57,300 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:28:57,308 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'What are the current CAIC observations for the Aspen zone?'}], Output: ChatCompletion(id='chatcmpl-8Kz03UjPVq35N5UX21bSRJPXob2ZE', choices=[Choice(finish_reason='function_call', index=0, message=ChatCompletionMessage(content=None, role='assistant', function_call=FunctionCall(arguments='{\n  "zone": "Aspen"\n}', name='co_field_obv'), tool_calls=None))], created=1700011735, model='gpt-4-0613', object='chat.completion', system_fingerprint=None, usage=CompletionUsage(completion_tokens=18, prompt_tokens=230, total_tokens=248))
2023-11-14 18:28:57,312 - INFO - Method selected: co_field_obv
2023-11-14 18:29:00,654 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:29:00,662 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Pitkin", "state": "CO", "elevation": 7908, "latitude": 39.1911, "longitude": -106.8175}
2023-11-14 18:29:06,886 - INFO - Generating response - System Context: You are a helpful assistant. Summarize the context below in relation to the user question. <context> [[{'observed_at': '2023-11-14T07:00:00.000Z', 'backcountry_zone': 'Aspen', 'url': 'https://api.avalanche.state.co.us/api/v2/observation_reports/ac6a11f4-8458-46f1-8b1c-2b373fcc905d.json', 'area': 'Hunter-Fryingpan Wilderness', 'route': 'Driving around the Frying Pan as far as the snow would safely allow.', 'avalanche_observations': None, 'weather_observation': None, 'snowpack_observations': [{'id': '171c009f-b2c7-4653-ae44-5ca3c2a89559', 'type': 'snowpack_observation', 'backcountry_zone_id': 'eea3da9e-28a3-4327-906e-132937649559', 'backcountry_zone': {'id': 'eea3da9e-28a3-4327-906e-132937649559', 'type': 'backcountry_zone', 'parent_id': '3ffc2e26-7641-422e-91ea-e025380c7777', 'slug': 'aspen', 'title': 'Aspen', 'category': 'backcountry', 'category_order': 4, 'is_root': False, 'is_leaf': True, 'tree_level': 2, 'parent_url': 'https://api.avalanche.state.co.us/api/v2/zones/central-mountains.json', 'created_at': '2019-10-31T21:41:58.551Z', 'updated_at': '2020-06-09T23:06:09.514Z', 'url': 'https://api.avalanche.state.co.us/api/v2/zones/aspen.json', 'geojson_url': 'https://api.avalanche.state.co.us/api/v2/zones/map/aspen.geojson'}, 'highway_zone_id': None, 'observed_at': '2023-11-14T07:00:00.000Z', 'created_at': '2023-11-15T00:01:04Z', 'updated_at': '2023-11-15T00:01:04Z', 'latitude': 39.2593433, 'longitude': -106.5424669, 'comments': None, 'url': 'https://api.avalanche.state.co.us/api/v2/snowpack_observations/171c009f-b2c7-4653-ae44-5ca3c2a89559.json', 'cracking': 'None', 'collapsing': 'None', 'weak_layers': None, 'rose': '000000000000000000000000', 'snowpack_detail': {'id': '8bda2024-071c-45ae-a0f4-947278b47b91', 'type': 'snowpack_detail', 'description': 'The few shady slopes I got to were 10-20cm deep with well-developed facets making up the top 2-3cm of the snowpack on top of a P-hard (on the hand hardness scale) melt-freeze crust with another layer of well-developed, striated, 3mm facets down to the ground. Looking at the west side of the Continental divide the snowpack is very thin with rocky and terrain features breaking the snow surface everywhere. The only slopes with continuous snow coverage were the tops of leeward-facing slopes and cross-loaded gullies.', 'classic_id': None}}], 'weather_detail': {'id': '9130ce73-dc33-4afb-9882-66239b0b362e', 'type': 'weather_detail', 'description': 'Calm bluebird day with a cold morning warming up to above-freezing temperatures after about 9:00 AM around 9500 feet.', 'classic_id': None}, 'snowpack_detail': {'id': '8bda2024-071c-45ae-a0f4-947278b47b91', 'type': 'snowpack_detail', 'description': 'The few shady slopes I got to were 10-20cm deep with well-developed facets making up the top 2-3cm of the snowpack on top of a P-hard (on the hand hardness scale) melt-freeze crust with another layer of well-developed, striated, 3mm facets down to the ground. Looking at the west side of the Continental divide the snowpack is very thin with rocky and terrain features breaking the snow surface everywhere. The only slopes with continuous snow coverage were the tops of leeward-facing slopes and cross-loaded gullies.', 'classic_id': None}}, {'observed_at': '2023-11-13T07:00:00.000Z', 'backcountry_zone': 'Aspen', 'url': 'https://api.avalanche.state.co.us/api/v2/observation_reports/b085b37c-f763-44e6-b666-e684487c7393.json', 'area': None, 'route': 'Washington Gulch to Paradise Divide', 'avalanche_observations': None, 'weather_observation': None, 'snowpack_observations': [{'id': 'ff0b9f09-3b92-48d9-9396-113c0e5ac752', 'type': 'snowpack_observation', 'backcountry_zone_id': 'eea3da9e-28a3-4327-906e-132937649559', 'backcountry_zone': {'id': 'eea3da9e-28a3-4327-906e-132937649559', 'type': 'backcountry_zone', 'parent_id': '3ffc2e26-7641-422e-91ea-e025380c7777', 'slug': 'aspen', 'title': 'Aspen', 'category': 'backcountry', 'category_order': 4, 'is_root': False, 'is_leaf': True, 'tree_level': 2, 'parent_url': 'https://api.avalanche.state.co.us/api/v2/zones/central-mountains.json', 'created_at': '2019-10-31T21:41:58.551Z', 'updated_at': '2020-06-09T23:06:09.514Z', 'url': 'https://api.avalanche.state.co.us/api/v2/zones/aspen.json', 'geojson_url': 'https://api.avalanche.state.co.us/api/v2/zones/map/aspen.geojson'}, 'highway_zone_id': None, 'observed_at': '2023-11-13T07:00:00.000Z', 'created_at': '2023-11-14T00:21:03Z', 'updated_at': '2023-11-14T00:21:03Z', 'latitude': 38.9881644, 'longitude': -107.0622847, 'comments': None, 'url': 'https://api.avalanche.state.co.us/api/v2/snowpack_observations/ff0b9f09-3b92-48d9-9396-113c0e5ac752.json', 'cracking': 'Minor', 'collapsing': 'None', 'weak_layers': None, 'rose': '000000000000000000000000', 'snowpack_detail': {'id': '82826417-2be1-485b-9f33-92efeef48112', 'type': 'snowpack_detail', 'description': "Northerly-facing slopes near treeline, or wind-sheltered spots above treeline will not hold much of a slab if snowfall ramps up next weekend.\r\nSoutheast and west-facing slopes held wet snow, that will freeze into an icy mass. Snow-covered slopes on these aspects might work as a future bed surface, but they lack prominent weak layers up to around 12,000' (no hands-on observations from higher elevations) or maybe higher.\r\nSouth and southwest slopes are mostly melted out and post little concern in the next week to ten days.", 'classic_id': None}}], 'weather_detail': {'id': '85169ce8-271f-4c07-974f-93ff21e37726', 'type': 'weather_detail', 'description': 'Warm with a gentle breeze.', 'classic_id': None}, 'snowpack_detail': {'id': '82826417-2be1-485b-9f33-92efeef48112', 'type': 'snowpack_detail', 'description': "Northerly-facing slopes near treeline, or wind-sheltered spots above treeline will not hold much of a slab if snowfall ramps up next weekend.\r\nSoutheast and west-facing slopes held wet snow, that will freeze into an icy mass. Snow-covered slopes on these aspects might work as a future bed surface, but they lack prominent weak layers up to around 12,000' (no hands-on observations from higher elevations) or maybe higher.\r\nSouth and southwest slopes are mostly melted out and post little concern in the next week to ten days.", 'classic_id': None}}]] <context> 
2023-11-14 18:29:21,648 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:34:26,553 - INFO - User query: What are the current CAIC observations for the Aspen zone?
2023-11-14 18:34:27,851 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:34:27,861 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'What are the current CAIC observations for the Aspen zone?'}], Output: ChatCompletion(id='chatcmpl-8Kz5OvgkvYv15WJlAQquxU4OJa58O', choices=[Choice(finish_reason='function_call', index=0, message=ChatCompletionMessage(content=None, role='assistant', function_call=FunctionCall(arguments='{\n  "zone": "Aspen"\n}', name='co_field_obv'), tool_calls=None))], created=1700012066, model='gpt-4-0613', object='chat.completion', system_fingerprint=None, usage=CompletionUsage(completion_tokens=18, prompt_tokens=230, total_tokens=248))
2023-11-14 18:34:27,865 - INFO - Method selected: co_field_obv
2023-11-14 18:34:30,024 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:34:30,032 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Pitkin", "state": "CO", "elevation": 7908, "latitude": 39.1911, "longitude": -106.8175}
2023-11-14 18:34:36,382 - INFO - Generating response - System Context: You are a helpful assistant. Summarize the context below in relation to the user question. <context> ['Provide a detailed, bulleted summary of the following observations: [{\'observed_at\': \'2023-11-14T07:00:00.000Z\', \'backcountry_zone\': \'Aspen\', \'url\': \'https://api.avalanche.state.co.us/api/v2/observation_reports/ac6a11f4-8458-46f1-8b1c-2b373fcc905d.json\', \'area\': \'Hunter-Fryingpan Wilderness\', \'route\': \'Driving around the Frying Pan as far as the snow would safely allow.\', \'avalanche_observations\': None, \'weather_observation\': None, \'snowpack_observations\': [{\'id\': \'171c009f-b2c7-4653-ae44-5ca3c2a89559\', \'type\': \'snowpack_observation\', \'backcountry_zone_id\': \'eea3da9e-28a3-4327-906e-132937649559\', \'backcountry_zone\': {\'id\': \'eea3da9e-28a3-4327-906e-132937649559\', \'type\': \'backcountry_zone\', \'parent_id\': \'3ffc2e26-7641-422e-91ea-e025380c7777\', \'slug\': \'aspen\', \'title\': \'Aspen\', \'category\': \'backcountry\', \'category_order\': 4, \'is_root\': False, \'is_leaf\': True, \'tree_level\': 2, \'parent_url\': \'https://api.avalanche.state.co.us/api/v2/zones/central-mountains.json\', \'created_at\': \'2019-10-31T21:41:58.551Z\', \'updated_at\': \'2020-06-09T23:06:09.514Z\', \'url\': \'https://api.avalanche.state.co.us/api/v2/zones/aspen.json\', \'geojson_url\': \'https://api.avalanche.state.co.us/api/v2/zones/map/aspen.geojson\'}, \'highway_zone_id\': None, \'observed_at\': \'2023-11-14T07:00:00.000Z\', \'created_at\': \'2023-11-15T00:01:04Z\', \'updated_at\': \'2023-11-15T00:01:04Z\', \'latitude\': 39.2593433, \'longitude\': -106.5424669, \'comments\': None, \'url\': \'https://api.avalanche.state.co.us/api/v2/snowpack_observations/171c009f-b2c7-4653-ae44-5ca3c2a89559.json\', \'cracking\': \'None\', \'collapsing\': \'None\', \'weak_layers\': None, \'rose\': \'000000000000000000000000\', \'snowpack_detail\': {\'id\': \'8bda2024-071c-45ae-a0f4-947278b47b91\', \'type\': \'snowpack_detail\', \'description\': \'The few shady slopes I got to were 10-20cm deep with well-developed facets making up the top 2-3cm of the snowpack on top of a P-hard (on the hand hardness scale) melt-freeze crust with another layer of well-developed, striated, 3mm facets down to the ground. Looking at the west side of the Continental divide the snowpack is very thin with rocky and terrain features breaking the snow surface everywhere. The only slopes with continuous snow coverage were the tops of leeward-facing slopes and cross-loaded gullies.\', \'classic_id\': None}}], \'weather_detail\': {\'id\': \'9130ce73-dc33-4afb-9882-66239b0b362e\', \'type\': \'weather_detail\', \'description\': \'Calm bluebird day with a cold morning warming up to above-freezing temperatures after about 9:00 AM around 9500 feet.\', \'classic_id\': None}, \'snowpack_detail\': {\'id\': \'8bda2024-071c-45ae-a0f4-947278b47b91\', \'type\': \'snowpack_detail\', \'description\': \'The few shady slopes I got to were 10-20cm deep with well-developed facets making up the top 2-3cm of the snowpack on top of a P-hard (on the hand hardness scale) melt-freeze crust with another layer of well-developed, striated, 3mm facets down to the ground. Looking at the west side of the Continental divide the snowpack is very thin with rocky and terrain features breaking the snow surface everywhere. The only slopes with continuous snow coverage were the tops of leeward-facing slopes and cross-loaded gullies.\', \'classic_id\': None}}, {\'observed_at\': \'2023-11-13T07:00:00.000Z\', \'backcountry_zone\': \'Aspen\', \'url\': \'https://api.avalanche.state.co.us/api/v2/observation_reports/b085b37c-f763-44e6-b666-e684487c7393.json\', \'area\': None, \'route\': \'Washington Gulch to Paradise Divide\', \'avalanche_observations\': None, \'weather_observation\': None, \'snowpack_observations\': [{\'id\': \'ff0b9f09-3b92-48d9-9396-113c0e5ac752\', \'type\': \'snowpack_observation\', \'backcountry_zone_id\': \'eea3da9e-28a3-4327-906e-132937649559\', \'backcountry_zone\': {\'id\': \'eea3da9e-28a3-4327-906e-132937649559\', \'type\': \'backcountry_zone\', \'parent_id\': \'3ffc2e26-7641-422e-91ea-e025380c7777\', \'slug\': \'aspen\', \'title\': \'Aspen\', \'category\': \'backcountry\', \'category_order\': 4, \'is_root\': False, \'is_leaf\': True, \'tree_level\': 2, \'parent_url\': \'https://api.avalanche.state.co.us/api/v2/zones/central-mountains.json\', \'created_at\': \'2019-10-31T21:41:58.551Z\', \'updated_at\': \'2020-06-09T23:06:09.514Z\', \'url\': \'https://api.avalanche.state.co.us/api/v2/zones/aspen.json\', \'geojson_url\': \'https://api.avalanche.state.co.us/api/v2/zones/map/aspen.geojson\'}, \'highway_zone_id\': None, \'observed_at\': \'2023-11-13T07:00:00.000Z\', \'created_at\': \'2023-11-14T00:21:03Z\', \'updated_at\': \'2023-11-14T00:21:03Z\', \'latitude\': 38.9881644, \'longitude\': -107.0622847, \'comments\': None, \'url\': \'https://api.avalanche.state.co.us/api/v2/snowpack_observations/ff0b9f09-3b92-48d9-9396-113c0e5ac752.json\', \'cracking\': \'Minor\', \'collapsing\': \'None\', \'weak_layers\': None, \'rose\': \'000000000000000000000000\', \'snowpack_detail\': {\'id\': \'82826417-2be1-485b-9f33-92efeef48112\', \'type\': \'snowpack_detail\', \'description\': "Northerly-facing slopes near treeline, or wind-sheltered spots above treeline will not hold much of a slab if snowfall ramps up next weekend.\\r\\nSoutheast and west-facing slopes held wet snow, that will freeze into an icy mass. Snow-covered slopes on these aspects might work as a future bed surface, but they lack prominent weak layers up to around 12,000\' (no hands-on observations from higher elevations) or maybe higher.\\r\\nSouth and southwest slopes are mostly melted out and post little concern in the next week to ten days.", \'classic_id\': None}}], \'weather_detail\': {\'id\': \'85169ce8-271f-4c07-974f-93ff21e37726\', \'type\': \'weather_detail\', \'description\': \'Warm with a gentle breeze.\', \'classic_id\': None}, \'snowpack_detail\': {\'id\': \'82826417-2be1-485b-9f33-92efeef48112\', \'type\': \'snowpack_detail\', \'description\': "Northerly-facing slopes near treeline, or wind-sheltered spots above treeline will not hold much of a slab if snowfall ramps up next weekend.\\r\\nSoutheast and west-facing slopes held wet snow, that will freeze into an icy mass. Snow-covered slopes on these aspects might work as a future bed surface, but they lack prominent weak layers up to around 12,000\' (no hands-on observations from higher elevations) or maybe higher.\\r\\nSouth and southwest slopes are mostly melted out and post little concern in the next week to ten days.", \'classic_id\': None}}]'] <context> 
2023-11-14 18:34:44,293 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:35:09,603 - INFO - File uploaded to gs://ask-bc-analytics/feedback/2023-11-14_18-35-08-939.json
2023-11-14 18:35:20,652 - INFO - User query: What are the current CAIC observations for the Vail zone?
2023-11-14 18:35:22,101 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:35:22,110 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'What are the current CAIC observations for the Vail zone?'}], Output: ChatCompletion(id='chatcmpl-8Kz6GRHotEgylMwLlhoh6Ce8beN1r', choices=[Choice(finish_reason='function_call', index=0, message=ChatCompletionMessage(content=None, role='assistant', function_call=FunctionCall(arguments='{\n  "zone": "Vail & Summit County"\n}', name='co_field_obv'), tool_calls=None))], created=1700012120, model='gpt-4-0613', object='chat.completion', system_fingerprint=None, usage=CompletionUsage(completion_tokens=21, prompt_tokens=231, total_tokens=252))
2023-11-14 18:35:22,114 - INFO - Method selected: co_field_obv
2023-11-14 18:35:24,707 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:35:24,714 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Eagle", "state": "CO", "elevation": 8150, "latitude": 39.6403, "longitude": -106.3742}
2023-11-14 18:35:30,770 - INFO - Generating response - System Context: You are a helpful assistant. Summarize the context below in relation to the user question. <context> ["Provide a detailed, bulleted summary of the following observations: [{'observed_at': '2023-11-10T07:00:00.000Z', 'backcountry_zone': 'Vail & Summit County', 'url': 'https://api.avalanche.state.co.us/api/v2/observation_reports/485c46b2-7281-4b62-b0ed-4b967c7ea8f3.json', 'area': None, 'route': 'Climbing Hoosier Ridge, I noticed a somewhat recent avalanche at the location listed above.', 'avalanche_observations': [{'id': '28858c8d-b4f2-423d-803a-89c88b106ed0', 'type': 'avalanche_observation', 'backcountry_zone_id': '0b270614-a0d3-4368-a011-9a6594ea857e', 'backcountry_zone': {'id': '0b270614-a0d3-4368-a011-9a6594ea857e', 'type': 'backcountry_zone', 'parent_id': '743b73eb-deb4-4f10-b6f4-a1bd2bd9f55f', 'slug': 'vail-and-summit-county', 'title': 'Vail & Summit County', 'category': 'backcountry', 'category_order': 2, 'is_root': False, 'is_leaf': True, 'tree_level': 2, 'parent_url': 'https://api.avalanche.state.co.us/api/v2/zones/northern-mountains.json', 'created_at': '2019-10-31T21:41:58.045Z', 'updated_at': '2020-06-09T23:06:09.496Z', 'url': 'https://api.avalanche.state.co.us/api/v2/zones/vail-and-summit-county.json', 'geojson_url': 'https://api.avalanche.state.co.us/api/v2/zones/map/vail-and-summit-county.geojson'}, 'highway_zone_id': None, 'observed_at': '2023-11-11T19:00:00.000Z', 'created_at': '2023-11-13T13:39:03Z', 'updated_at': '2023-11-13T13:39:03Z', 'latitude': 39.366199, 'longitude': -106.0420025, 'comments': None, 'url': 'https://api.avalanche.state.co.us/api/v2/avalanche_observations/28858c8d-b4f2-423d-803a-89c88b106ed0.json', 'location': None, 'firstname': 'Korben', 'lastname': 'Cooper', 'full_name': 'Korben Cooper', 'date_known': 'Estimated', 'time_known': 'Unknown', 'number': 1, 'is_locked': False, 'hw_op_bc': 'bc', 'path': None, 'landmark': None, 'type_code': 'U', 'problem_type': None, 'aspect': 'NE', 'elevation': 'TL', 'relative_size': 'U', 'destructive_size': 'D1', 'primary_trigger': 'N', 'secondary_trigger': None, 'is_incident': False, 'area': None, 'angle': None, 'angle_average': None, 'angle_maximum': None, 'elevation_feet': None, 'surface': None, 'weak_layer': None, 'weak_layer_hardness': None, 'weak_layer_hardness_modifier': None, 'weak_layer_grain_type': None, 'weak_layer_grain_size': None, 'weak_layer_thickness': None, 'bed_surface_hardness': None, 'bed_surface_hardness_modifier': None, 'bed_surface_grain_type': None, 'bed_surface_grain_size': None, 'grain_type': None, 'crown_measured': None, 'crown_average': None, 'crown_maximum': None, 'crown_units': 'in', 'crown_location': None, 'slab_hardness': None, 'slab_hardness_modifier': None, 'slab_grain_type': None, 'slab_grain_size': None, 'slab_grain_comments': None, 'start_zone_elevation': None, 'start_zone_elevation_units': 'ft', 'start_zone_slope_angle_average': None, 'start_zone_slope_angle_maximum': None, 'start_zone_aspect_start': None, 'start_zone_aspect_end': None, 'start_zone_ground_cover': None, 'start_zone_snow_moisture': None, 'start_zone_comments': None, 'track_slope_angle_average': None, 'track_aspect': None, 'track_snow_moisture': None, 'track_shape': None, 'debris_toe_elevation': None, 'debris_toe_elevation_units': 'ft', 'debris_density_average': None, 'debris_type': None, 'run_out_average_incline': None, 'run_out_aspect': None, 'run_out_ground_cover': None, 'run_out_snow_moisture': None, 'alpha_angle_individual_avalanche': None, 'alpha_angle_extreme_event': None, 'had_terrain_trap': None, 'terrain_trap_type': None, 'avalanche_path_comments': None, 'width_average': None, 'width_maximum': None, 'width_units': 'ft', 'vertical_average': None, 'vertical_maximum': None, 'vertical_units': 'ft', 'terminus': None, 'road_status': None, 'road_depth': None, 'road_depth_units': 'ft', 'road_length': None, 'road_length_units': 'ft'}], 'weather_observation': None, 'snowpack_observations': [{'id': '75ac8d32-df22-4065-abd4-9ab3730c8c90', 'type': 'snowpack_observation', 'backcountry_zone_id': '0b270614-a0d3-4368-a011-9a6594ea857e', 'backcountry_zone': {'id': '0b270614-a0d3-4368-a011-9a6594ea857e', 'type': 'backcountry_zone', 'parent_id': '743b73eb-deb4-4f10-b6f4-a1bd2bd9f55f', 'slug': 'vail-and-summit-county', 'title': 'Vail & Summit County', 'category': 'backcountry', 'category_order': 2, 'is_root': False, 'is_leaf': True, 'tree_level': 2, 'parent_url': 'https://api.avalanche.state.co.us/api/v2/zones/northern-mountains.json', 'created_at': '2019-10-31T21:41:58.045Z', 'updated_at': '2020-06-09T23:06:09.496Z', 'url': 'https://api.avalanche.state.co.us/api/v2/zones/vail-and-summit-county.json', 'geojson_url': 'https://api.avalanche.state.co.us/api/v2/zones/map/vail-and-summit-county.geojson'}, 'highway_zone_id': None, 'observed_at': '2023-11-10T07:00:00.000Z', 'created_at': '2023-11-12T23:00:03Z', 'updated_at': '2023-11-12T23:00:03Z', 'latitude': 39.366199, 'longitude': -106.0420025, 'comments': None, 'url': 'https://api.avalanche.state.co.us/api/v2/snowpack_observations/75ac8d32-df22-4065-abd4-9ab3730c8c90.json', 'cracking': 'None', 'collapsing': 'Minor', 'weak_layers': None, 'rose': '000000000000000000000000'}], 'weather_detail': None, 'snowpack_detail': None}]"] <context> 
2023-11-14 18:35:38,865 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:38:59,183 - INFO - User query: What are the current CAIC observations for the Vail zone?
2023-11-14 18:39:00,691 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:39:00,696 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'What are the current CAIC observations for the Vail zone?'}], Output: ChatCompletion(id='chatcmpl-8Kz9nop9eu04vsWZ2u4uKDIv7z8QY', choices=[Choice(finish_reason='function_call', index=0, message=ChatCompletionMessage(content=None, role='assistant', function_call=FunctionCall(arguments='{\n  "zone": "Vail & Summit County"\n}', name='co_field_obv'), tool_calls=None))], created=1700012339, model='gpt-4-0613', object='chat.completion', system_fingerprint=None, usage=CompletionUsage(completion_tokens=21, prompt_tokens=231, total_tokens=252))
2023-11-14 18:39:00,697 - INFO - Method selected: co_field_obv
2023-11-14 18:39:02,975 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:39:02,983 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Eagle", "state": "CO", "elevation": 8150, "latitude": 39.6403, "longitude": -106.3742}
2023-11-14 18:39:09,176 - INFO - Generating response - System Context: You are a helpful assistant. Summarize the context below in relation to the user question. <context> ["Provide a detailed, bulleted summary of the following observations: [{'observed_at': '2023-11-10T07:00:00.000Z', 'backcountry_zone': 'Vail & Summit County', 'url': 'https://avalanche.state.co.us/observations/field-report/485c46b2-7281-4b62-b0ed-4b967c7ea8f3', 'area': None, 'route': 'Climbing Hoosier Ridge, I noticed a somewhat recent avalanche at the location listed above.', 'avalanche_observations': [{'id': '28858c8d-b4f2-423d-803a-89c88b106ed0', 'type': 'avalanche_observation', 'backcountry_zone_id': '0b270614-a0d3-4368-a011-9a6594ea857e', 'backcountry_zone': {'id': '0b270614-a0d3-4368-a011-9a6594ea857e', 'type': 'backcountry_zone', 'parent_id': '743b73eb-deb4-4f10-b6f4-a1bd2bd9f55f', 'slug': 'vail-and-summit-county', 'title': 'Vail & Summit County', 'category': 'backcountry', 'category_order': 2, 'is_root': False, 'is_leaf': True, 'tree_level': 2, 'parent_url': 'https://api.avalanche.state.co.us/api/v2/zones/northern-mountains.json', 'created_at': '2019-10-31T21:41:58.045Z', 'updated_at': '2020-06-09T23:06:09.496Z', 'url': 'https://api.avalanche.state.co.us/api/v2/zones/vail-and-summit-county.json', 'geojson_url': 'https://api.avalanche.state.co.us/api/v2/zones/map/vail-and-summit-county.geojson'}, 'highway_zone_id': None, 'observed_at': '2023-11-11T19:00:00.000Z', 'created_at': '2023-11-13T13:39:03Z', 'updated_at': '2023-11-13T13:39:03Z', 'latitude': 39.366199, 'longitude': -106.0420025, 'comments': None, 'url': 'https://api.avalanche.state.co.us/api/v2/avalanche_observations/28858c8d-b4f2-423d-803a-89c88b106ed0.json', 'location': None, 'firstname': 'Korben', 'lastname': 'Cooper', 'full_name': 'Korben Cooper', 'date_known': 'Estimated', 'time_known': 'Unknown', 'number': 1, 'is_locked': False, 'hw_op_bc': 'bc', 'path': None, 'landmark': None, 'type_code': 'U', 'problem_type': None, 'aspect': 'NE', 'elevation': 'TL', 'relative_size': 'U', 'destructive_size': 'D1', 'primary_trigger': 'N', 'secondary_trigger': None, 'is_incident': False, 'area': None, 'angle': None, 'angle_average': None, 'angle_maximum': None, 'elevation_feet': None, 'surface': None, 'weak_layer': None, 'weak_layer_hardness': None, 'weak_layer_hardness_modifier': None, 'weak_layer_grain_type': None, 'weak_layer_grain_size': None, 'weak_layer_thickness': None, 'bed_surface_hardness': None, 'bed_surface_hardness_modifier': None, 'bed_surface_grain_type': None, 'bed_surface_grain_size': None, 'grain_type': None, 'crown_measured': None, 'crown_average': None, 'crown_maximum': None, 'crown_units': 'in', 'crown_location': None, 'slab_hardness': None, 'slab_hardness_modifier': None, 'slab_grain_type': None, 'slab_grain_size': None, 'slab_grain_comments': None, 'start_zone_elevation': None, 'start_zone_elevation_units': 'ft', 'start_zone_slope_angle_average': None, 'start_zone_slope_angle_maximum': None, 'start_zone_aspect_start': None, 'start_zone_aspect_end': None, 'start_zone_ground_cover': None, 'start_zone_snow_moisture': None, 'start_zone_comments': None, 'track_slope_angle_average': None, 'track_aspect': None, 'track_snow_moisture': None, 'track_shape': None, 'debris_toe_elevation': None, 'debris_toe_elevation_units': 'ft', 'debris_density_average': None, 'debris_type': None, 'run_out_average_incline': None, 'run_out_aspect': None, 'run_out_ground_cover': None, 'run_out_snow_moisture': None, 'alpha_angle_individual_avalanche': None, 'alpha_angle_extreme_event': None, 'had_terrain_trap': None, 'terrain_trap_type': None, 'avalanche_path_comments': None, 'width_average': None, 'width_maximum': None, 'width_units': 'ft', 'vertical_average': None, 'vertical_maximum': None, 'vertical_units': 'ft', 'terminus': None, 'road_status': None, 'road_depth': None, 'road_depth_units': 'ft', 'road_length': None, 'road_length_units': 'ft'}], 'weather_observation': None, 'snowpack_observations': [{'id': '75ac8d32-df22-4065-abd4-9ab3730c8c90', 'type': 'snowpack_observation', 'backcountry_zone_id': '0b270614-a0d3-4368-a011-9a6594ea857e', 'backcountry_zone': {'id': '0b270614-a0d3-4368-a011-9a6594ea857e', 'type': 'backcountry_zone', 'parent_id': '743b73eb-deb4-4f10-b6f4-a1bd2bd9f55f', 'slug': 'vail-and-summit-county', 'title': 'Vail & Summit County', 'category': 'backcountry', 'category_order': 2, 'is_root': False, 'is_leaf': True, 'tree_level': 2, 'parent_url': 'https://api.avalanche.state.co.us/api/v2/zones/northern-mountains.json', 'created_at': '2019-10-31T21:41:58.045Z', 'updated_at': '2020-06-09T23:06:09.496Z', 'url': 'https://api.avalanche.state.co.us/api/v2/zones/vail-and-summit-county.json', 'geojson_url': 'https://api.avalanche.state.co.us/api/v2/zones/map/vail-and-summit-county.geojson'}, 'highway_zone_id': None, 'observed_at': '2023-11-10T07:00:00.000Z', 'created_at': '2023-11-12T23:00:03Z', 'updated_at': '2023-11-12T23:00:03Z', 'latitude': 39.366199, 'longitude': -106.0420025, 'comments': None, 'url': 'https://api.avalanche.state.co.us/api/v2/snowpack_observations/75ac8d32-df22-4065-abd4-9ab3730c8c90.json', 'cracking': 'None', 'collapsing': 'Minor', 'weak_layers': None, 'rose': '000000000000000000000000'}], 'weather_detail': None, 'snowpack_detail': None}]"] <context> 
2023-11-14 18:39:15,226 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:40:12,022 - INFO - User query: What are the current CAIC observations for the Aspen zone?
2023-11-14 18:40:13,638 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:40:13,648 - INFO - Method selector - System Context: [{'role': 'user', 'content': 'What are the current CAIC observations for the Aspen zone?'}], Output: ChatCompletion(id='chatcmpl-8KzAymF7Q2n4AB26LZZRlZs8hl38n', choices=[Choice(finish_reason='function_call', index=0, message=ChatCompletionMessage(content=None, role='assistant', function_call=FunctionCall(arguments='{\n  "zone": "Aspen"\n}', name='co_field_obv'), tool_calls=None))], created=1700012412, model='gpt-4-0613', object='chat.completion', system_fingerprint=None, usage=CompletionUsage(completion_tokens=18, prompt_tokens=230, total_tokens=248))
2023-11-14 18:40:13,652 - INFO - Method selected: co_field_obv
2023-11-14 18:40:16,355 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:40:16,362 - INFO - Location extraction - System Context: You will be provided with a text, and your task is to extract the county, state, elevation, latitude, and longitude from it.Do not attempt to answer the question. Only extract the location information.If you are unsure return None. #### Example ### Text: How much snow is at Loveland Pass? Response: {"county": "Clear Creek", "state": "CO", "elevation": 11900, "latitude": 39.6806, "longitude": -105.8972}#### Example ### Text: What is the weather forecast for 81632? Response: {"county": "Eagle", "state": "CO", "elevation": 7200, "latitude": 39.6445, "longitude": -106.5933}, Output: {"county": "Pitkin", "state": "CO", "elevation": 7908, "latitude": 39.1911, "longitude": -106.8175}
2023-11-14 18:40:22,808 - INFO - Generating response - System Context: You are a helpful assistant. Summarize the context below in relation to the user question. <context> ['Provide a detailed, bulleted summary of the following observations. Return the value of the "url" key as well: [{\'observed_at\': \'2023-11-14T07:00:00.000Z\', \'backcountry_zone\': \'Aspen\', \'url\': \'https://avalanche.state.co.us/observations/field-report/ac6a11f4-8458-46f1-8b1c-2b373fcc905d\', \'area\': \'Hunter-Fryingpan Wilderness\', \'route\': \'Driving around the Frying Pan as far as the snow would safely allow.\', \'avalanche_observations\': None, \'weather_observation\': None, \'snowpack_observations\': [{\'id\': \'171c009f-b2c7-4653-ae44-5ca3c2a89559\', \'type\': \'snowpack_observation\', \'backcountry_zone_id\': \'eea3da9e-28a3-4327-906e-132937649559\', \'backcountry_zone\': {\'id\': \'eea3da9e-28a3-4327-906e-132937649559\', \'type\': \'backcountry_zone\', \'parent_id\': \'3ffc2e26-7641-422e-91ea-e025380c7777\', \'slug\': \'aspen\', \'title\': \'Aspen\', \'category\': \'backcountry\', \'category_order\': 4, \'is_root\': False, \'is_leaf\': True, \'tree_level\': 2, \'parent_url\': \'https://api.avalanche.state.co.us/api/v2/zones/central-mountains.json\', \'created_at\': \'2019-10-31T21:41:58.551Z\', \'updated_at\': \'2020-06-09T23:06:09.514Z\', \'url\': \'https://api.avalanche.state.co.us/api/v2/zones/aspen.json\', \'geojson_url\': \'https://api.avalanche.state.co.us/api/v2/zones/map/aspen.geojson\'}, \'highway_zone_id\': None, \'observed_at\': \'2023-11-14T07:00:00.000Z\', \'created_at\': \'2023-11-15T00:01:04Z\', \'updated_at\': \'2023-11-15T00:01:04Z\', \'latitude\': 39.2593433, \'longitude\': -106.5424669, \'comments\': None, \'url\': \'https://api.avalanche.state.co.us/api/v2/snowpack_observations/171c009f-b2c7-4653-ae44-5ca3c2a89559.json\', \'cracking\': \'None\', \'collapsing\': \'None\', \'weak_layers\': None, \'rose\': \'000000000000000000000000\', \'snowpack_detail\': {\'id\': \'8bda2024-071c-45ae-a0f4-947278b47b91\', \'type\': \'snowpack_detail\', \'description\': \'The few shady slopes I got to were 10-20cm deep with well-developed facets making up the top 2-3cm of the snowpack on top of a P-hard (on the hand hardness scale) melt-freeze crust with another layer of well-developed, striated, 3mm facets down to the ground. Looking at the west side of the Continental divide the snowpack is very thin with rocky and terrain features breaking the snow surface everywhere. The only slopes with continuous snow coverage were the tops of leeward-facing slopes and cross-loaded gullies.\', \'classic_id\': None}}], \'weather_detail\': {\'id\': \'9130ce73-dc33-4afb-9882-66239b0b362e\', \'type\': \'weather_detail\', \'description\': \'Calm bluebird day with a cold morning warming up to above-freezing temperatures after about 9:00 AM around 9500 feet.\', \'classic_id\': None}, \'snowpack_detail\': {\'id\': \'8bda2024-071c-45ae-a0f4-947278b47b91\', \'type\': \'snowpack_detail\', \'description\': \'The few shady slopes I got to were 10-20cm deep with well-developed facets making up the top 2-3cm of the snowpack on top of a P-hard (on the hand hardness scale) melt-freeze crust with another layer of well-developed, striated, 3mm facets down to the ground. Looking at the west side of the Continental divide the snowpack is very thin with rocky and terrain features breaking the snow surface everywhere. The only slopes with continuous snow coverage were the tops of leeward-facing slopes and cross-loaded gullies.\', \'classic_id\': None}}, {\'observed_at\': \'2023-11-13T07:00:00.000Z\', \'backcountry_zone\': \'Aspen\', \'url\': \'https://avalanche.state.co.us/observations/field-report/b085b37c-f763-44e6-b666-e684487c7393\', \'area\': None, \'route\': \'Washington Gulch to Paradise Divide\', \'avalanche_observations\': None, \'weather_observation\': None, \'snowpack_observations\': [{\'id\': \'ff0b9f09-3b92-48d9-9396-113c0e5ac752\', \'type\': \'snowpack_observation\', \'backcountry_zone_id\': \'eea3da9e-28a3-4327-906e-132937649559\', \'backcountry_zone\': {\'id\': \'eea3da9e-28a3-4327-906e-132937649559\', \'type\': \'backcountry_zone\', \'parent_id\': \'3ffc2e26-7641-422e-91ea-e025380c7777\', \'slug\': \'aspen\', \'title\': \'Aspen\', \'category\': \'backcountry\', \'category_order\': 4, \'is_root\': False, \'is_leaf\': True, \'tree_level\': 2, \'parent_url\': \'https://api.avalanche.state.co.us/api/v2/zones/central-mountains.json\', \'created_at\': \'2019-10-31T21:41:58.551Z\', \'updated_at\': \'2020-06-09T23:06:09.514Z\', \'url\': \'https://api.avalanche.state.co.us/api/v2/zones/aspen.json\', \'geojson_url\': \'https://api.avalanche.state.co.us/api/v2/zones/map/aspen.geojson\'}, \'highway_zone_id\': None, \'observed_at\': \'2023-11-13T07:00:00.000Z\', \'created_at\': \'2023-11-14T00:21:03Z\', \'updated_at\': \'2023-11-14T00:21:03Z\', \'latitude\': 38.9881644, \'longitude\': -107.0622847, \'comments\': None, \'url\': \'https://api.avalanche.state.co.us/api/v2/snowpack_observations/ff0b9f09-3b92-48d9-9396-113c0e5ac752.json\', \'cracking\': \'Minor\', \'collapsing\': \'None\', \'weak_layers\': None, \'rose\': \'000000000000000000000000\', \'snowpack_detail\': {\'id\': \'82826417-2be1-485b-9f33-92efeef48112\', \'type\': \'snowpack_detail\', \'description\': "Northerly-facing slopes near treeline, or wind-sheltered spots above treeline will not hold much of a slab if snowfall ramps up next weekend.\\r\\nSoutheast and west-facing slopes held wet snow, that will freeze into an icy mass. Snow-covered slopes on these aspects might work as a future bed surface, but they lack prominent weak layers up to around 12,000\' (no hands-on observations from higher elevations) or maybe higher.\\r\\nSouth and southwest slopes are mostly melted out and post little concern in the next week to ten days.", \'classic_id\': None}}], \'weather_detail\': {\'id\': \'85169ce8-271f-4c07-974f-93ff21e37726\', \'type\': \'weather_detail\', \'description\': \'Warm with a gentle breeze.\', \'classic_id\': None}, \'snowpack_detail\': {\'id\': \'82826417-2be1-485b-9f33-92efeef48112\', \'type\': \'snowpack_detail\', \'description\': "Northerly-facing slopes near treeline, or wind-sheltered spots above treeline will not hold much of a slab if snowfall ramps up next weekend.\\r\\nSoutheast and west-facing slopes held wet snow, that will freeze into an icy mass. Snow-covered slopes on these aspects might work as a future bed surface, but they lack prominent weak layers up to around 12,000\' (no hands-on observations from higher elevations) or maybe higher.\\r\\nSouth and southwest slopes are mostly melted out and post little concern in the next week to ten days.", \'classic_id\': None}}]'] <context> 
2023-11-14 18:40:33,709 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2023-11-14 18:41:06,472 - INFO - File uploaded to gs://ask-bc-analytics/feedback/2023-11-14_18-41-05-635.json
